\documentclass[a4paper, 12pt]{article}
\usepackage{cmap}
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage{amsthm}
\usepackage{upgreek}
\usepackage{setspace}
\usepackage{color}
\usepackage{pgfplots}
\usepackage{mathtools}
\pgfplotsset{compat=1.9}
\usepackage[T2A]{fontenc}
\usepackage[cp1251]{inputenc}
\usepackage[normalem]{ulem}
\usepackage{mathtext} % русские буквы в формулах
\usepackage[left=2cm,right=2cm, top=2cm,bottom=2cm,bindingoffset=0cm]{geometry}
\usepackage[english,russian]{babel}
\usepackage[unicode]{hyperref}
\newenvironment{Proof} % имя окружения
{\par\noindent{$\blacklozenge$}} % команды для \begin
{\hfill$\scriptstyle\boxtimes$}
\newcommand{\Rm}{\mathbb{R}}
\newcommand{\Cm}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\I}{\mathbb{I}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\rank}{\operatorname{rank}}
\newcommand{\Ra}{\Rightarrow}
\newcommand{\ra}{\rightarrow}
\newcommand{\FI}{\Phi}
\newcommand{\Sp}{\text{Sp}}
\renewcommand{\leq}{\leqslant}
\renewcommand{\geq}{\geqslant}
\renewcommand{\alpha}{\upalpha}
\renewcommand{\beta}{\upbeta}
\renewcommand{\gamma}{\upgamma}
\renewcommand{\delta}{\updelta}
\renewcommand{\varphi}{\upvarphi}
\renewcommand{\phi}{\upvarphi}
\renewcommand{\tau}{\uptau}
\renewcommand{\lambda}{\uplambda}
\renewcommand{\psi}{\uppsi}
\renewcommand{\mu}{\upmu}
\renewcommand{\omega}{\upomega}
\renewcommand{\d}{\partial}
\renewcommand{\xi}{\upxi}
\renewcommand{\epsilon}{\upvarepsilon}
\newcommand{\intx}{\int\limits_{x_0}^x}
\newcommand\Norm[1]{\left\| #1 \right\|}
\newcommand{\sumk}{\sum\limits_{k=0}^\infty}
\newcommand{\sumi}{\sum\limits_{i=0}^\infty}
\newtheorem*{theorem}{Теорема}
\newtheorem*{cor}{Следствие}
\newtheorem*{lem}{Лемма}
\begin{document}
	\section*{Разностная аппроксимация дифференциальных задач для ОДУ}
	\subsubsection*{Условия}
	\begin{enumerate}
		\item Построить разностную схему в индексной и безиндексной форме для дифференциальной задачи с граничными условиями первого рода
		$$\begin{cases}
			u''(x) + p(x) u'(x) + q(x) u(x) = -f(x),\ 0<x<1,\\
			u(0) = \mu_0,\\
			u(1) = \mu_1.
		\end{cases}$$
		Определить порядок аппроксимации разностной схемой. (\hyperlink{t1}{Решение})
		\item Построить разностную схему в индексной и безиндексной форме для дифференциальной задачи с граничными условиями второго рода
		$$\begin{cases}
			u''(x) + p(x) u'(x) + q(x) u(x) = -f(x),\ 0<x<1,\\
			u'(0) = \mu_0,\\
			u'(1) = \mu_1.
		\end{cases}$$
		Определить порядок аппроксимации разностной схемой. (\hyperlink{t2}{Решение})
		\item Построить разностную схему в индексной и безиндексной форме для дифференциальной задачи с граничными условиями третьего рода
		$$\begin{cases}
			u''(x) + p(x) u'(x) + q(x) u(x) = -f(x),\ 0<x<1,\\
			u'(0) = \sigma_0u(0) - \mu_0,\\
			u'(1) = \sigma_1u(1) - \mu_1.
		\end{cases}$$
		Определить порядок аппроксимации разностной схемой. (\hyperlink{t3}{Решение})
	\end{enumerate}
	
	\newpage
	\subsubsection*{Решения}
	\begin{enumerate}
		\item \hypertarget{t1}{}
		Разностную схему для дифференциальной задачи будем строить в два этапа.\\\\ \textbf{Первый этап} -- это задание сетки узлов. Для простоты зададим равномерную сетку узлов
		$$\overline \omega_h =\left\{x_i = ih,\ i = \overline{0,N}, h=\dfrac1N\right\},$$
		которую можно также представить в виде
		$$\overline \omega_h = \omega_h \cup \gamma _h,$$
		где $$\omega_h =\left\{x_i = ih,\ i = \overline{1,N-1}, h=\dfrac1N\right\},\ \gamma_h = \{x_0=0, x_N=1\}.$$
		Графически это можно изобразить как
		$$
		\includegraphics[scale=0.25]{images/img004}
		$$
		где точки из $\omega_h$ обозначены  через точки, а точки из $\gamma_h$ -- через крестики.
		На этой сетке мы определяем сеточную функцию $y = y(x), x\in \overline\omega _h$, которая будет являться дискретным аналогом (аппроксимацией) решения $u(x)$.\\\\
		\textbf{Второй этап.} Заменяя в исходном дифференциальном уравнении производные от функции на разностные аналоги, можем построить разностное уравнение
		$$y_{\overline x x}(x) + p(x)y_{\overset{\circ}{x}}(x) + q(x) y(x) = -f(x),\ x \in \omega_h,$$
		то есть такая аппроксимация будет на всех узлах сетки кроме 0 и 1. В краевых точках мы также заменяем исходную функцию на сеточную и получаем
		$$\begin{cases}
			y(0) = \mu_0,\\
			y(1) = \mu_1.
		\end{cases}$$
		Тогда, собрав вместе аппроксимацию уравнения и граничных условий, получим \textit{разностную аппроксимацию дифференциальной задачи в безиндексной форме}
		$$\begin{cases}
			y_{\overline x x}(x) + p(x)y_{\overset{\circ}{x}}(x) + q(x) y(x) = -f(x),\ x \in \omega_h,\\
			y(0) = \mu_0,\\
			y(1) = \mu_1.
		\end{cases}$$
		Чтобы записать эту задачу в индексной форме, распишем разностные производные, считая $y(x_i) = y_i$. Тогда получим \textit{разностную аппроксимацию дифференциальной задачи в индексной форме}
		$$\begin{cases}
			\dfrac{y_{i-1}-2y_i + y_{i+1}}{h^2} + p(x_i)\dfrac{y_{i+1}-y_{i-1}}{2h} + q(x_i) y_i = -f(x_i),\ i = \overline{1,N-1},\\
			y_0 = \mu_0,\\
			y_N = \mu_1.
		\end{cases}$$
		Далее нам нужно исследовать порядок аппроксимации задачи разностной схемой. Для этого рассмотрим поведение погрешности аппроксимации для уравнения, а затем для граничных условий:
		\begin{equation*}
			\psi_h(x) = u_{\overline x x}(x) + p(x)u_{\overset{\circ}{x}}(x) + q(x) u(x) +f(x).
		\end{equation*}
		Поскольку мы можем записать
		$$u_{\overline x x}(x) = u''(x) + \dfrac{h^2}{12}u^{IV}(x) + O(h^3),$$
		$$u_{\overset{\circ}{x}}(x) = u'(x) + \dfrac{h^2}{6}u'''(x) + O(h^3),$$
		то
		\begin{equation*}
			\psi_h(x) = u''(x) + \dfrac{h^2}{12}u^{IV}(x)  + p(x)\left[u'(x) + \dfrac{h^2}{6}u'''(x)\right] + q(x) u(x) +f(x) + O(h^3).
		\end{equation*}
		Из исходной задачи мы имеем $u''(x) + p(x) u'(x) + q(x) u(x) = -f(x)$, поэтому
		$$\psi_h(x) =\dfrac{h^2}{12}u^{IV}(x)+\dfrac{h^2}{6}u'''(x)+O(h^3) = O(h^2).$$
		То есть разностное уравнение аппроксимирует исходное дифференциальное уравнение со вторым порядком.
		Рассмотрим погрешность аппроксимации граничных условий
		$$\nu _h (0) = u(0) - \mu_0 = 0,$$
		$$\nu_h(1) = u(1) - \mu_1 = 0,$$
		то есть граничные условия аппроксимируются точно $$\nu_h(x) = \nu_h(0) + \nu_h(1)=0.$$
		Таким образом, общий порядок аппроксимации $$\Psi_h(x) = \psi_h(x) + \nu_h(x) = O(h^2),$$ то есть разностная схема аппроксимирует поставленную дифференциальную задачу со вторым порядком точности. \\\\
		\textbf{Замечание.} Все эти результаты были получены за счет замены первой производной центральной разностной производной $u'(x) = u_{\overset{\circ}{x}}(x)$. Такая аппроксимация имеет погрешность $\psi_h(x) = O(h^2)$. Если бы мы заменили первую производную на левую (правую) разностную производную, то погрешность такой аппроксимации была бы $\psi_h(x) = O(h)$. А тогда можно показать, что и дифференциальное уравнение и, как следствие, вся дифференциальная задача будут аппроксимироваться с первым порядком точности.
		
		\newpage
		\item 
		\hypertarget{t2}{}
		Разностную схему для дифференциальной задачи будем строить в два этапа.\\\\ \textbf{Первый этап} -- это задание сетки узлов. Для простоты зададим равномерную сетку узлов
		$$\overline \omega_h =\left\{x_i = ih,\ i = \overline{0,N}, h=\dfrac1N\right\},$$
		которую можно также представить в виде
		$$\overline \omega_h = \omega_h \cup \gamma _h,$$
		где $$\omega_h =\left\{x_i = ih,\ i = \overline{1,N-1}, h=\dfrac1N\right\},\ \gamma_h = \{x_0=0, x_N=1\}.$$
		Графически это можно изобразить как
		$$
		\includegraphics[scale=0.25]{images/img004}
		$$
		где точки из $\omega_h$ обозначены  через точки, а точки из $\gamma_h$ -- через крестики.
		На этой сетке мы определяем сеточную функцию $y = y(x), x\in \overline\omega _h$, которая будет являться дискретным аналогом (аппроксимацией) решения $u(x)$.\\\\
		\textbf{Второй этап.} Заменяя в исходном дифференциальном уравнении производные от функции на разностные аналоги, можем построить разностное уравнение
		$$y_{\overline x x}(x) + p(x)y_{\overset{\circ}{x}}(x) + q(x) y(x) = -f(x),\ x \in \omega_h,$$
		то есть такая аппроксимация будет на всех узлах сетки кроме 0 и 1. В краевых точках мы также заменяем исходную функцию на сеточный аналог и получаем
		$$\begin{cases}
			y_x(0) = \mu_0,\\
			y_{\overline x}(1) = \mu_1.
		\end{cases}$$
		Заметим, что в данном случае мы можем заменить левое (правое) граничное условие только правой (левой) разностной производной, поскольку от левой (правой) границы мы можем двигаться только вправо (влево).\\\\
		Тогда, собрав вместе аппроксимацию уравнения и граничных условий, получим \textit{разностную аппроксимацию дифференциальной задачи в безиндексной форме}
		$$\begin{cases}
			y_{\overline x x}(x) + p(x)y_{\overset{\circ}{x}}(x) + q(x) y(x) = -f(x),\ x \in \omega_h,\\
			y_x(0) = \mu_0,\\
			y_{\overline x}(1) = \mu_1.
		\end{cases}$$
		Чтобы записать эту задачу в индексной форме, распишем разностные производные, считая $y(x_i) = y_i$. Тогда получим \textit{разностную аппроксимацию дифференциальной задачи в индексной форме}
		$$\begin{dcases}
			\dfrac{y_{i-1}-2y_i + y_{i+1}}{h^2} + p(x_i)\dfrac{y_{i+1}-y_{i-1}}{2h} + q(x_i) y_i = -f(x_i),\ i = \overline{1,N-1},\\
			\dfrac{y_{1}-y_{0}}{h}= \mu_0,\\
			\dfrac{y_{N}-y_{N-1}}{h} = \mu_1.
		\end{dcases}$$
		Далее нам нужно исследовать порядок аппроксимации задачи разностной схемой. Для этого рассмотрим поведение погрешности аппроксимации для уравнения, а затем для граничных условий:
		\begin{equation*}
			\psi_h(x) = u_{\overline x x}(x) + p(x)u_{\overset{\circ}{x}}(x) + q(x) u(x) +f(x).
		\end{equation*}
		Поскольку мы можем записать
		$$u_{\overline x x}(x) = u''(x) + \dfrac{h^2}{12}u^{IV}(x) + O(h^3),$$
		$$u_{\overset{\circ}{x}}(x) = u'(x) + \dfrac{h^2}{6}u'''(x) + O(h^3),$$
		то
		\begin{equation*}
			\psi_h(x) = u''(x) + \dfrac{h^2}{12}u^{IV}(x)  + p(x)\left[u'(x) + \dfrac{h^2}{6}u'''(x)\right] + q(x) u(x) +f(x) + O(h^3).
		\end{equation*}
		Из исходной задачи мы имеем $u''(x) + p(x) u'(x) + q(x) u(x) = -f(x)$, поэтому
		$$\psi_h(x) =\dfrac{h^2}{12}u^{IV}(x)+\dfrac{h^2}{6}u'''(x)+O(h^3) = O(h^2).$$
		То есть разностное уравнение аппроксимирует исходное дифференциальное уравнение со вторым порядком.
		Учитывая, что
		$$u_x (x)= u'(x) + \dfrac{h}{2} u''(x) + O(h^2),$$
		$$u_{\overline x}(x) = u'(x) + \dfrac{h}{2} u''(x) + O(h^2),$$
		рассмотрим погрешность аппроксимации граничных условий,
		$$\nu _h (0) = u_x(0) - \mu_0 = u'(0) + \dfrac{h}{2}u''(0) + O(h^2) - \mu_0 = \dfrac{h}{2}u''(0) + O(h^2) = O(h),$$
		$$\nu _h (1) = u_{\overline x}(1) - \mu_1 = u'(1) + \dfrac{h}{2}u''(1) + O(h^2) - \mu_1 = \dfrac{h}{2}u''(1) + O(h^2) = O(h).$$
		то есть граничные условия аппроксимируются с первым порядком $$\nu_h = \nu_h(0) + \nu_h(1) = O(h).$$
		Таким образом, общий порядок аппроксимации $$\Psi_h(x) = \psi_h(x) + \nu_h(x) = O(h),$$ то есть разностная схема аппроксимирует поставленную дифференциальную задачу с первым порядком точности. 
		
		\newpage
		\item 
		\hypertarget{t3}{}
		Разностную схему для дифференциальной задачи будем строить в два этапа.\\\\ \textbf{Первый этап} -- это задание сетки узлов. Для простоты зададим равномерную сетку узлов
		$$\overline \omega_h =\left\{x_i = ih,\ i = \overline{0,N}, h=\dfrac1N\right\},$$
		которую можно также представить в виде
		$$\overline \omega_h = \omega_h \cup \gamma _h,$$
		где $$\omega_h =\left\{x_i = ih,\ i = \overline{1,N-1}, h=\dfrac1N\right\},\ \gamma_h = \{x_0=0, x_N=1\}.$$
		Графически это можно изобразить как
		$$
		\includegraphics[scale=0.25]{images/img004}
		$$
		где точки из $\omega_h$ обозначены  через точки, а точки из $\gamma_h$ -- через крестики.
		На этой сетке мы определяем сеточную функцию $y = y(x), x\in \overline\omega _h$, которая будет являться дискретным аналогом (аппроксимацией) решения $u(x)$.\\\\
		\textbf{Второй этап.} Заменяя в исходном дифференциальном уравнении производные от функции на разностные аналоги, можем построить разностное уравнение
		$$y_{\overline x x}(x) + p(x)y_{\overset{\circ}{x}}(x) + q(x) y(x) = -f(x),\ x \in \omega_h,$$
		то есть такая аппроксимация будет на всех узлах сетки кроме 0 и 1. В краевых точках мы также заменяем исходную функцию на сеточный аналог и получаем
		$$\begin{cases}
			y_x(0) = \sigma_0 y(0) - \mu_0,\\
			y_{\overline x}(1) = \sigma_1 y(1) - \mu_1.
		\end{cases}$$
		Заметим, что в данном случае мы можем заменить левое (правое) граничное условие только правой (левой) разностной производной, поскольку от левой (правой) границы мы можем двигаться только вправо (влево).\\\\
		Тогда, собрав вместе аппроксимацию уравнения и граничных условий, получим \textit{разностную аппроксимацию дифференциальной задачи в безиндексной форме}
		$$\begin{cases}
			y_{\overline x x}(x) + p(x)y_{\overset{\circ}{x}}(x) + q(x) y(x) = -f(x),\ x \in \omega_h,\\
			y_x(0) = \sigma_0 y(0) - \mu_0,\\
			y_{\overline x}(1) = \sigma_1 y(1) - \mu_1.
		\end{cases}$$
		Чтобы записать эту задачу в индексной форме, распишем разностные производные, считая $y(x_i) = y_i$. Тогда получим \textit{разностную аппроксимацию дифференциальной задачи в индексной форме}
		$$\begin{dcases}
			\dfrac{y_{i-1}-2y_i + y_{i+1}}{h^2} + p(x_i)\dfrac{y_{i+1}-y_{i-1}}{2h} + q(x_i) y_i = -f(x_i),\ i = \overline{1,N-1},\\
			\dfrac{y_{1}-y_{0}}{h}= \sigma_0 y_0 - \mu_0,\\
			\dfrac{y_{N}-y_{N-1}}{h} = \sigma_1 y_N - \mu_1.
		\end{dcases}$$
		Далее нам нужно исследовать порядок аппроксимации задачи разностной схемой. Для этого рассмотрим поведение погрешности аппроксимации для уравнения, а затем для граничных условий:
		\begin{equation*}
			\psi_h(x) = u_{\overline x x}(x) + p(x)u_{\overset{\circ}{x}}(x) + q(x) u(x) +f(x).
		\end{equation*}
		Поскольку мы можем записать
		$$u_{\overline x x}(x) = u''(x) + \dfrac{h^2}{12}u^{IV}(x) + O(h^3),$$
		$$u_{\overset{\circ}{x}}(x) = u'(x) + \dfrac{h^2}{6}u'''(x) + O(h^3),$$
		то
		\begin{equation*}
			\psi_h(x) = u''(x) + \dfrac{h^2}{12}u^{IV}(x)  + p(x)\left[u'(x) + \dfrac{h^2}{6}u'''(x)\right] + q(x) u(x) +f(x) + O(h^3).
		\end{equation*}
		Из исходной задачи мы имеем $u''(x) + p(x) u'(x) + q(x) u(x) = -f(x)$, поэтому
		$$\psi_h(x) =\dfrac{h^2}{12}u^{IV}(x)+\dfrac{h^2}{6}u'''(x)+O(h^3) = O(h^2).$$
		То есть разностное уравнение аппроксимирует исходное дифференциальное уравнение со вторым порядком.
		Учитывая, что
		$$u_x (x)= u'(x) + \dfrac{h}{2} u''(x) + O(h^2),$$
		$$u_{\overline x}(x) = u'(x) + \dfrac{h}{2} u''(x) + O(h^2),$$
		рассмотрим погрешность аппроксимации граничных условий,
		$$\nu _h (0) = u_x(0) - \sigma_0 u(0) + \mu_0 = u'(0) + \dfrac{h}{2}u''(0) + O(h^2) - \sigma_0 u(0) + \mu_0 .$$
		Из поставленной задачи нам известно, что $u'(0) = \sigma_0 u(0) +\mu_0$. Тогда, используя этот факт, получим
		$$\nu_h(0) = \dfrac{h}{2}u''(0) + O(h^2) = O(h).$$
		Аналогично для второго граничного условия
		$$\nu _h (1) = u_{\overline x}(1) - \sigma_1 u(1) + \mu_1= u'(1) + \dfrac{h}{2}u''(1) + O(h^2) - \sigma_1 u(1) + \mu_1 = \dfrac{h}{2}u''(1) + O(h^2) = O(h).$$
		то есть граничные условия аппроксимируются с первым порядком $$\nu_h = \nu_h(0) + \nu_h(1) = O(h).$$
		Таким образом, общий порядок аппроксимации $$\Psi_h(x) = \psi_h(x) + \nu_h(x) = O(h),$$ то есть разностная схема аппроксимирует поставленную дифференциальную задачу с первым порядком точности. 
	\end{enumerate}
	
\end{document} 