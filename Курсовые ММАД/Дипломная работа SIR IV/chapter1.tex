\chapter[БАЗОВЫЕ МАТЕМАТИЧЕСКИЕ МОДЕЛИ ЗАБОЛЕВАНИЙ]{БАЗОВЫЕ МАТЕМАТИЧЕСКИЕ МОДЕЛИ ЗАБОЛЕВАНИЙ}\label{chap1}

В данной главе формулируются классические модели распространения заболеваний, основанные на задачах Коши для систем дифференциальных уравнений. Приводятся модификации базовой модели путем добавления новых параметров и условий для протекания заболеваний. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Классическая SI-модель}\label{1sec:si-model}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Изучение математических моделей для описания заболеваний мы начнем с рассмотрения простейшей «двухгрупповой» модели Suspected-Infected (SI), иначе говоря, Здоровые-Инфицированные.
Данный подход основывается на следующем утверждении: для любого промежутка времени верно, что количество человек, присоединившихся к больным, равно количеству человек, переставших быть здоровыми. 

Сформулируем математически эту модель. Пусть определено некоторое множество $T \subset \mathbb R$, которое задает некоторый временной промежуток. И пусть также
\begin{itemize}
	\item $t \in T$ --- независимая переменная, обозначающая некоторый момент времени;
	\item $\beta \in \mathbb R$ -- вероятность заражения здорового человека при контакте с больным;
	\item $S(t) : T \to \mathbb R$ -- функция, определяющая количество здоровых людей в момент времени $t$; 
	\item $I(t): T \to \mathbb R$ -- функция, определяющая количество больных людей в момент времени $t$;
	\item $N \in \mathbb R$ --- общая численность населения.
\end{itemize}
Ввиду этих обозначений, в соответствии с указанным ранее утверждением, имеет место запись 
\begin{equation*}
	S(t) + I(t) = N,
\end{equation*}
смысл которой заключается в том, что количество здоровых и больных людей должны изменяться таким образом, что общая численность населения остается постоянной.
Скорость изменения числа здоровых и больных людей с течением времени можно записать, используя аппарат дифференциальных уравнений, в виде следующей системы:
\begin{eqnarray}
	\label{si-1}
	\begin{dcases}
		\dfrac{\d S(t)}{\d t} = -\beta\cdot S(t)\cdot I(t),\\
		\dfrac{\d I(t)}{\d t} = \beta\cdot S(t)\cdot I(t).
	\end{dcases}
\end{eqnarray}
Также для того, чтобы получить не семейство решений дифференциального уравнения, а одно частное решение, с помощью которого мы можем описывать процесс распространения конкретного заболевания, на дифференциальную систему накладываются  начальные условия
$$
S(t_0) = S_0,\ I(t_0) = I_0.
$$
Зачастую принято считать $t_0$ -- точкой начала отсчета, что позволяет записывать начальные условия
\begin{equation}
	S(0) = S_0,\ I(0) = I_0.
\end{equation}
Используя тот факт, что $S(t) + I(t) = N$,  и накладывая начальные условия на систему, можно переписать дифференциальную задачу \eqref{si-1} в виде системы независимых друг от друга дифференциальных уравнений
\begin{eqnarray}
	\label{si-2}
	\begin{dcases}
		\dfrac{\d S(t)}{\d t} = -\beta \cdot S(t)\cdot (N - S(t)),\\
		\dfrac{\d I(t)}{\d t} = \beta\cdot (N - I(t))\cdot I(t),\\
		S(0) = S_0,\ I(0) = I_0.
	\end{dcases}
\end{eqnarray}
Здесь произведение 
$$S(t) \cdot (N - S(t)) = I(t)\cdot (N - I(t)) = S(t)\cdot I(t)$$
равно количеству контактов за единичный промежуток времени в случае, если каждый здоровый контактирует с каждым больным. [3]

Схематически эту модель можно представить следующим образом (Рис. 1.1).

\begin{figure}[h!]
	\center{\includegraphics[scale=0.25]{images/img05}}
	
	\dfig{Схема перехода индивидов модели SI}\label{fig1}
\end{figure}

В первом уравнении дифференциальной задачи \eqref{si-2} расписано количество ушедших из множества здоровых $S(t)$ (левая часть уравнения) как доля заразившихся при контактах (правая часть уравнения). Во втором уравнении количество новоприбывших в множество больных $I(t)$ (левая часть уравнения) расписывается как доля заразившихся при контактах (правая часть уравнения). 

Основным недостатком подхода является предположение о том, что больные и здоровые равномерно распределены по пространству. Как следствие, показатель $\beta$ является константой для всех участников социальной сети, и считается, что контакты происходят между всеми парами <<больной-здоровый>>. Также модель предсказывает на уровне численности и не делает никаких предположений о том, кто именно заболевает в следующий момент времени.

Для дифференциальной задачи \eqref{si-2} мы можем построить как численное, так и аналитическое решение. Причем аналитическое решение данной системы уравнений построить несложно. Для этого, раскрыв скобки, преобразуем систему следующим образом
$$
\begin{dcases}
	\dfrac{\d S(t)}{\d t} + \beta\cdot  N \cdot S(t) = \beta \cdot S^2(t),\\
	\dfrac{\d I(t)}{\d t} - \beta\cdot N\cdot I(t) =  -\beta\cdot  I^2(t),\\
	S(0) = S_0,\ I(0) = I_0.
\end{dcases}
$$
Оба уравнения данной системы являются дифференциальными уравнениями Бернулли, для которых можно легко выписать аналитическое решение. В итоге имеем
\begin{equation}
	S(t) = \dfrac{N \cdot S_0}{-S_0 \cdot e^{\beta \cdot N\cdot t} + S_0 + N\cdot e^{\beta \cdot N \cdot t}},
\end{equation}
\begin{equation}
	I(t) = \dfrac{I_0 \cdot N \cdot e^{\beta \cdot N \cdot t}}{I_0\cdot(e^{\beta \cdot N \cdot t} - 1) + N}.
\end{equation}
Исследовать методы построения численного решения системы \eqref{si-2} мы не будем. Лишь укажем, что в качестве одного из базовых подходов можно использовать численный метод Рунге-Кутты, который реализован в большинстве пакетов.

Таким образом, SI-модель позволяет нам описывать быстротекущие эпидемии. Если же мы планируем моделировать более серьезные эпидемии, то такая модель будет недостаточно эффективной.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Классическая SIR-модель}\label{1sec:sir-model}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

В популяционных моделях население некоторого региона рассматривается как совокупность групп, как правило, отражающих различный статус индивидов по отношению к заболеванию (восприимчивые, инфицированные, больные в разных стадиях, индивиды в состоянии ремиссии). Внутри каждой группы индивиды считаются неразличимыми между собой. Численности групп меняются со временем в результате следующих процессов:
\begin{itemize}
	\item переходы индивидов из одной группы в другую вследствие
	инфицирования, развития заболевания, выявления и лечения заболевших
	индивидов;
	\item пополнение групп за счёт иммиграции и рождения индивидов;
	\item убыль в результате естественной смертности индивидуумов, гибели из–за
	болезни и эмиграции в другие регионы.
\end{itemize}
Наиболее популярными среди популяционных моделей являются SIR–модели, в которых рассматривается три группы индивидов --- восприимчивые к заболеванию (Susceptible), инфицированные (Infected) и переболевшие либо удалённые
(Recovered/Removed). Передача инфекции осуществляется от инфицированных
индивидов к восприимчивым. Переболевшие индивиды приобретают
иммунитет и не могут быть заражены вторично. Математически такие модели
задаются системами дифференциальных (непрерывное время) или разностных
(дискретное время) уравнений. Эти уравнения описывают закон изменения
численностей групп индивидов с течением времени.

Существуют многочисленные типы моделей, производные от SIR, среди
которых можно назвать следующие:
\begin{itemize}
	\item SIRS («Susceptible — Infected — Recovered — Susceptible») – модель,
	описывающая динамику заболеваний c временным иммунитетом
	(выздоровевшие индивиды по прошествии времени опять становятся
	восприимчивыми);
	\item SEIR («Susceptible — Exposed — Infected — Recovered») – модель для
	заболеваний с инкубационным периодом;
	\item SIS («Susceptible — Exposed — Infected) – модель, не учитывающая
	приобретение иммунитета;
	\item MSIR (M — «maternally derived immunity») – модель включает в
	популяцию новорождённых детей, приобретающих иммунитет
	внутриутробно;
	\item и так далее.
\end{itemize}
Подробнее вариации этих моделей будут исследованы в п. 1.4.
\subsection{Достоинства и недостатки}
Плюсом популяционных SIR–моделей
является простота в построении и использовании, возможность аналитического
исследования, лёгкость настройки на реальные данные. Ограничением подхода
является значительное усложнение математического описания моделей при
учёте таких факторов, как существенная неоднородность популяции,
нетривиальная схема передачи инфекции и пр. В детерминированных
популяционных моделях не может быть учтён фактор случайности в
распространении заболеваний, особенно значимый в малых популяциях и при
небольшом числе инфицированных, например, в начальной фазе
распространения заболевания. Кроме того, в популяционных моделях
невозможен учёт особенностей отдельных индивидов, что усложняет или
делает невозможным их использование для решения ряда задач, относящихся к
эпидемиологии. 
\subsection{Формулировка SIR-модели в непрерывном времени}
В качестве примера SIR–модели в непрерывном времени можно привести
классическую модель Кермака–Маккендрика. Она  основана на разделении населения на три группы: $S$ -- восприимчивые (Susceptible), $I$ -- инфицированные (Infectious) и $R$ -- имеющие иммунитет (Recovered): $$N = S + I + R,$$ где $N$ -- общая численность населения.
Таким образом, мы можем ввести следующие математические обозначения для переменных и параметров модели. Пусть определено некоторое множество $T \subset \mathbb R$, которое задает некоторый временной промежуток. И пусть также
\begin{itemize}
	\item $t \in T$ --- независимая переменная, обозначающая некоторый момент времени;
	\item $\beta\in \mathbb R$ -- коэффициент интенсивности контактов индивидов с
	последующим инфицированием;
	\item $\gamma\in \mathbb R$ -- коэффициент интенсивности выздоровления
	инфицированных индивидов;
	\item $S(t): T \to \mathbb R$ -- количество здоровых людей в момент времени $t$; 
	\item $I(t): T \to \mathbb R$ -- количество больных людей в момент времени $t$;
	\item $R(t): T \to \mathbb R$ -- количество переболевших людей в момент времени $t$
	\item $N \in \mathbb R$ --- общая численность населения.
\end{itemize}
«Восприимчивые» относятся к группе людей, наиболее уязвимых к заболеванию после контакта с инфицированными людьми. На момент заражения они могут уже быть больными или иметь какое-то хроническое заболевание. Группа «инфицированные» представляет уже зараженных инфекцией людей. Они могут передать болезнь группе восприимчивых людей и могут со временем выздороветь. Выздоровевшие пациенты приобретают иммунитет, так как они больше не подвержены этому заболеванию. [5]

Модель SIR задается в общем виде системой обыкновенных дифференциальных уравнений, на которую накладываются начальные условия. Таким образом, классическая SIR-модель может быть задана в виде задачи Коши
\begin{equation}
	\begin{dcases}
		\dfrac {\d S(t)}{\d t} = -\beta \cdot S(t) \cdot I(t),\\
		\dfrac{\d I(t)}{\d t} = \beta \cdot S(t)\cdot I(t) - \gamma\cdot I(t),\\
		\dfrac{\d R(t)}{\d t} = \gamma\cdot I(t), \\
		S(0) = S_0,\ I(0) = I_0,\ R(0) = 0.
	\end{dcases}
\end{equation}
Это структура, описывающая, как количество людей в каждой группе изменяется в течении времени. 

Схематически эту модель можно представить следующим образом (Рис. 1.2)
\begin{figure}[h!]
	\center{\includegraphics[scale=0.25]{images/img06}}
	
	\dfig{Схема перехода индивидов модели SIR}\label{fig2}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Построение задачи Коши для базовой SIR-модели}\label{1sec:sir-cauchy}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Рассмотрим начальный момент времени $t_0$, то есть начало эпидемии в данном случае. Пусть у нас имеется один инфицированный индивидуум из группы $I(t)$ и некоторое количество восприимчивых людей из группы $S(t)$. В результате контактов, данный инфицированный индивидуум заражает какое-то количество восприимчивых, тем самым переводит их из группы $S(t)$ в группу $I(t)$, то есть совершается переход $$S \to I.$$
Введем новую величину $\beta$ -- интенсивность заражения или же  среднее количество контактов на одного человека во времени. Тогда мы можем считать, что один инфицированный заразил в среднем $\beta$ индивидуумов за единицу времени.

Для дальнейшего описания в уравнении (1), предполагая $N\ne 0$, разделим обе части уравнения на $N$ и получим 
\begin{eqnarray}
	\label{const-eq}
	\dfrac{S(t)}{N} + \dfrac{I(t)}{N} + \dfrac{R(t)}N = 1.
\end{eqnarray}
Тогда мы имеем следующие функции:
\begin{itemize}
	\item $s(t) = \dfrac {S(t)} N$ -- доля подверженных инфицированию индивидуумов;
	\item $i(t) = \dfrac{I(t)} N$ -- доля инфицированных индивидуумов;
	\item $r(t) = \dfrac{R(t)} N$ -- доля выздоровевших, «привитых» и умерших индивидуумов.
\end{itemize}

Теперь рассмотрим середину эпидемии. Пусть к этому моменту в популяции, кроме двух упомянутых категорий людей, появились переболевшие или выздоровевшие индивидуумы из группы $R(t)$, то есть осуществлялся переход $$I \to R.$$ Рассмотрим конкретного инфицированного и оценим, сколько людей он может заразить. Причем это число уже не равно $\beta$, потому что у нас в популяции есть люди
невосприимчивые к данной инфекции. Поэтому значение $\beta$ надо уменьшить, а именно умножить на долю всех восприимчивых людей в данный момент времени в популяции $\beta \cdot s(t)$. Таким образом это и есть количество инфицированных людей за единицу времени одним конкретным человеком. 

Общее количество всех инфицированных за единицу времени увеличивается на
величину $$\beta \cdot s(t) \cdot i(t).$$
Отметим, что величина $s(t)\cdot i(t)$
представляет собой плотность контактов между членами групп
$S(t)$ и $I(t)$.

С другой стороны, изменение величины за единицу времени из физических соображений понимается как скорость, которая определяется как производная этой величины по времени. Тогда мы можем записать введенную  скорость изменения плотности подверженных инфицированию как 
\begin{eqnarray}
	\label{s-comp}
	\dfrac {\d s(t)}{\d t} = -\beta \cdot s(t) \cdot i(t),
\end{eqnarray}
причем доля восприимчивых индивидуумов за единицу времени
уменьшается на данную величину, поэтому спереди ставим знак « $-$ ».
Реальное же значение количестве всех инфицированных за единицу времени будет несколько отличаться от наших вычислений, оно будет меньше, так как, разные инфицированные могут заразить одного и того же человека, но мы этим пренебрегаем. 

Далее для исследования изменения доли инфицированных людей за единицу времени мы введем еще одну величину $\gamma$ -- интенсивность выздоровления. Она выражает количество людей, которые
выздоравливают и переходят в группу $R(t)$ за единицу времени. Например, если болезнь длится $D$ дней, и в течение этого
периода инфицированный индивидуум может заразить еще кого-то, то $$\gamma = \dfrac 1D.$$
В среднем $\frac 1D$ всех инфицированных переходит в категорию выздоровевших за единицу времени.

Ввиду определенной величины $\gamma$, мы можем теперь оценить скорость изменения доли инфицированных людей за единицу времени как 
\begin{eqnarray}
	\label{i-comp}
	\dfrac{\d i(t)}{\d t} = \beta \cdot s(t)\cdot i(t) - \gamma\cdot i(t).
\end{eqnarray}
Отметим, что описанная простейшая модель не содержит демографических
факторов (рождение, смертность от других причин). Таким образом она пригодна для
краткосрочного прогноза, когда количество новорожденных и умерших за
рассматриваемый период сравнительно мало (т.е. $N\approx \operatorname{const}$).

Остается определить скорость изменения доли выздоровевших, «привитых» и умерших за единицу времени. С использованием введенных обозначений мы можем ее запросто определить как  
\begin{eqnarray}
	\label{r-comp}
	\dfrac{\d r(t)}{\d t} = \gamma\cdot i(t).
\end{eqnarray}

Таким образом, собрав все полученные уравнения \eqref{s-comp}-\eqref{r-comp}, мы получаем систему обыкновенных дифференциальных уравнений
\begin{equation}
	\label{sir-1}
	\left\{ 
	\begin{gathered} 
		\begin{aligned}
			\dfrac {\d s(t)}{\d t} &= -\beta \cdot s(t) \cdot i(t),\\
			\dfrac{\d i(t)}{\d t} &= \beta \cdot s(t)\cdot i(t) - \gamma\cdot i(t),\\
			\dfrac{\d r(t)}{\d t} &= \gamma\cdot i(t). 
		\end{aligned}
	\end{gathered} 
	\right.		
\end{equation}
Причем, сложив все уравнения, мы получим 
\begin{equation}
	\dfrac {\d s(t)}{\d t} + \dfrac {\d i(t)}{\d t} + \dfrac {\d r(t)}{\d t} = 0,
\end{equation}
а в силу уравнения \eqref{const-eq}, имеем 
\begin{equation}
	\label{const-eq-1}
	s(t) + i(t) + r(t) = 1.
\end{equation}
Теперь необходимо поставить задачу для системы уравнений \eqref{sir-1}. Наложим следующие начальные условия 
\begin{equation}
	\label{constr}
	s(t_0) = s_0 \approx 1,\quad i(t_0) = i_0 << 1,\quad r(t_0) = 0,
\end{equation}
которые в нашем случае определяют начало эпидемии следующим образом: в начальный момент времени $t_0$ у нас есть некоторая группа $S(t_0)$ восприимчивых индивидуумов, которая стремится к числу $N$ (так как $s_0 = \frac{S(t_0)}N$), и некоторая группа $I(t_0)$ инфицированных индивидуумов (так как $i_0 = \frac{I(t_0)}N$), которая много меньше $N$, а количество выздоровевших индивидуумов равно нулю.

Собрав воедино систему \eqref{sir-1} и начальные условия \eqref{constr} мы получаем задачу Коши, которая является математической моделью распространения эпидемии 
$$
\begin{dcases}
	\dfrac {\d s(t)}{\d t} = -\beta \cdot s(t) \cdot i(t),\\
	\dfrac{\d i(t)}{\d t} = \beta \cdot s(t)\cdot i(t) - \gamma\cdot i(t),\\
	\dfrac{\d r(t)}{\d t} = \gamma\cdot i(t),\\
	s(t_0) = s_0 \approx 1,\quad i(t_0) = i_0 << 1,\quad r(t_0) = 0.
\end{dcases}
$$
\subsection{Корректная постановка задачи Коши для базовой SIR-модели} 
Рассмотрим систему уравнений SIR-модели:
\[
\begin{dcases}
	\dfrac{\mathrm{d}s(t)}{\mathrm{d}t} = -\beta \cdot s(t) \cdot i(t),\\
	\dfrac{\mathrm{d}i(t)}{\mathrm{d}t} = \beta \cdot s(t) \cdot i(t) - \gamma \cdot i(t),\\
	\dfrac{\mathrm{d}r(t)}{\mathrm{d}t} = \gamma \cdot i(t),
\end{dcases}
\]
с начальными условиями:
\[
s(t_0) = s_0 \approx 1, \quad i(t_0) = i_0 << 1, \quad r(t_0) = 0.
\]
Здесь \( s(t) \), \( i(t) \), \( r(t) \) -- это доли восприимчивого, инфицированного и выздоровевшего населения соответственно. Коэффициенты \( \beta > 0 \) и \( \gamma > 0 \) являются константами (это свойственно SIR-модели), характеризующими скорость передачи инфекции и выздоровления.

Для корректной постановки данной задачи Коши необходимо:
\begin{itemize}
	\item существование и единственность решения задачи Коши;
	\item устойчивость решения задачи Коши по входным данным.
\end{itemize}

SIR-модель представляет собой задачу Коши для системы обыкновенных дифференциальных уравнений первого порядка. Согласно теореме о существовании и единственности Пикара–Линдельёфа, решение задачи Коши существует и единственно, если правая часть системы
\[
\begin{cases}
	f_1(s, i, r) = -\beta \cdot s(t)\cdot  i(t),\\
	f_2(s, i, r) = \beta \cdot s(t)\cdot  i(t) - \gamma \cdot i(t),\\
	f_3(s, i, r) = \gamma\cdot  i(t),
\end{cases}
\]
удовлетворяет условиям локальной липшицевости. Заметим, что функции \( f_1, f_2, f_3 \) гладкие (дифференцируемы) по всем своим аргументам. Следовательно, система удовлетворяет требованиям теоремы, и для заданных начальных условий \( s_0, i_0, r_0 \) существует единственное решение.

Рассмотрим физический смысл и допустимость решения:
\begin{enumerate}
	\item Физический смысл переменных:
	\[
	s(t) \geq 0, \quad i(t) \geq 0, \quad r(t) \geq 0, \quad s(t) + i(t) + r(t) = 1.
	\]
	Это следует из интерпретации \( s, i, r \) как долей населения. 
	\item Сохранение суммы \( s(t) + i(t) + r(t) \):
	\[
	\frac{\mathrm{d}}{\mathrm{d}t}(s(t) + i(t) + r(t)) = \frac{\mathrm{d}s}{\mathrm{d}t} + \frac{\mathrm{d}i}{\mathrm{d}t} + \frac{\mathrm{d}r}{\mathrm{d}t} = 0.
	\]
	Таким образом, из начальных условий \( s_0 + i_0 + r_0 = 1 \) следует, что сумма остаётся равной 1 для всех \( t \).
	\item 
	Решение остаётся в области \( s, i, r \geq 0 \), так как:
	\begin{itemize}
		\item Переменная \( s(t) \) убывает (\( \frac{\mathrm{d}s}{\mathrm{d}t} \leq 0 \)).
		\item Переменная \( r(t) \) возрастает (\( \frac{\mathrm{d}r}{\mathrm{d}t} \geq 0 \)).
		\item Переменная \( i(t) \) сначала может расти, но затем убывает.
	\end{itemize}
	Это гарантирует, что решение остается в физически осмысленной области (треугольник $s,i,r \geq 0$, $s+i+r = 1$).
\end{enumerate}

Начальные условия \( s_0 \approx 1 \), \( i_0 \ll 1 \), \( r_0 = 0 \) соответствуют началу эпидемического процесса, когда почти всё население восприимчиво, а число инфицированных мало. Анализ поведения решения показывает:
\begin{enumerate}
	\item Если \( \beta s_0 > \gamma \), то \( i(t) \) сначала растёт, что соответствует началу эпидемии.
	\item С течением времени \( i(t) \) убывает, и система стремится к состоянию, где \( i(t) \to 0 \), \( r(t) \to 1 - s(t) \), а \( s(t) \) стабилизируется.
\end{enumerate}

Таким образом, малые возмущения начальных условий (\( s_0, i_0, r_0 \)) действительно не приводят к разрыву решений или физически бессмысленным значениям.

Следовательно, задача Коши для SIR-модели является корректно поставленной, и имеет смысл искать ее решение.
\subsection{Аналитическое решение задачи Коши для базовой SIR-модели}
Рассмотрим составленную задачу Коши \eqref{sir-1}, \eqref{constr} вместе с уравнением \eqref{const-eq-1}
$$
\left\{ 
\begin{gathered} 
	\begin{aligned}
		\dfrac {\d s(t)}{\d t} &= -\beta \cdot s(t) \cdot i(t),\\
		\dfrac{\d i(t)}{\d t} &= \beta \cdot s(t)\cdot i(t) - \gamma\cdot i(t),\\
		\dfrac{\d r(t)}{\d t} &= \gamma\cdot i(t),
	\end{aligned}
\end{gathered} 
\right.
$$
$$
s(t) + i(t) + r(t) = 1,
$$
$$
s(t_0) = s_0,\quad i(t_0) = i_0,\quad r(t_0) = 0,
$$
В данной системе дифференциальных уравнений из третьего уравнения выразим $$i(t) = \dfrac1\gamma\cdot \dfrac{\d r(t)}{\d t}$$ и подставим это в первое уравнение:
$$\dfrac {\d s(t)}{\d t} = -\beta \cdot s(t) \cdot \dfrac1\gamma\cdot\dfrac{\d r(t)}{\d t}.$$
Перенесем все слагаемые в левую сторону и получим 
$$\dfrac {\d s(t)}{\d t} +\beta \cdot s(t) \cdot \dfrac1\gamma\cdot\dfrac{\d r(t)}{\d t} = 0.$$
Получили обыкновенное линейное дифференциальное уравнение относительно неизвестной функции $s(t)$. Домножим обе части уравнения на $$\exp \left(\int\limits_{t_0}^t \dfrac \beta \gamma\cdot \dfrac{\d r(t)}{\d t} \d t \right),$$
тогда
$$\dfrac {\d s(t)}{\d t} \exp \left(\int\limits_{t_0}^t \dfrac \beta \gamma\cdot \dfrac{\d r(t)}{\d t} \d t \right) +\beta \cdot s(t) \cdot \dfrac1\gamma\cdot\dfrac{\d r(t)}{\d t} \exp \left(\int\limits_{t_0}^t \dfrac \beta \gamma\cdot \dfrac{\d r(t)}{\d t} \d t \right) = 0.$$
Полученное выражение слева можно свернуть как производную произведения. Тогда 
$$\dfrac{\d}{\d t}\left[s(t)\cdot \exp \left(\int\limits_{t_0}^t \dfrac \beta \gamma\cdot \dfrac{\d r(t)}{\d t} \d t \right)\right] = 0.$$
В итоге мы получили простейшее обыкновенное дифференциальное уравнение первого порядка. Проинтегрируем его с двух сторон по $t$ и получим
$$s(t)\cdot \exp \left(\int\limits_{t_0}^t \dfrac \beta \gamma\cdot \dfrac{\d r(t)}{\d t} \d t \right) = C,\quad C = \operatorname{const}.$$
Распишем выражение с $\exp$: $$\exp \left(\dfrac \beta \gamma\cdot\int\limits_{t_0}^t  \dfrac{\d r(t)}{\d t} \d t \right) = \exp \left(\dfrac \beta \gamma\cdot( r(t) - r(t_0))\right) = \exp \left(\dfrac \beta \gamma\cdot r(t)\right).$$
Тогда, домножив получившееся равенство на $\exp\left(-\frac\beta \gamma r(t)\right)$, получим общее решение уравнения $$s(t) = C \exp\left(-\frac\beta \gamma r(t)\right).$$
Для определения $C$ подставим начальное условие $s(t_0) = s_0$:
$$s(t_0) = C = s_0.$$
Тогда получаем функцию 
\begin{equation}
	s(t) = s_0 \exp\left(-\frac \beta \gamma r(t)\right).
\end{equation}
Теперь, используя уравнение (1.13), выражаем 
\begin{equation}
	i(t) = 1 - s(t) - r(t) = 1 - s_0 \exp\left(-\frac \beta \gamma r(t)\right) - r(t)
\end{equation}
Подставляя это выражение в третье уравнение системы, получаем дифференциальное уравнение 
\begin{equation}
	\label{drdt-1}
	\dfrac{\d r(t)}{\d t} = \gamma\cdot \big[1 - s_0 \exp\left(-\frac \beta \gamma r(t)\right) - r(t)\big].
\end{equation}
Это уравнение является трансцедентным. Трансцендентным уравнением называют уравнение, в котором неизвестная величина является аргументом показательной, логарифмической или тригонометрической функции. Многие уравнения (трансцендентные), не имеют аналитических решений. Однако корни таких уравнений могут быть найдены численными методами с некоторой заранее заданной погрешностью.

В своей работе Кермак и Маккендрик предложили способ отыскания приближенного аналитического решения этого уравнения. В силу предположения, что значение $\frac{\beta}{\gamma} r(t)$ является относительно небольшим, можно приблизить значение $e^{-\frac \beta \gamma r(t)}$ алгебраическим многочленом $$\exp\left(-\frac \beta \gamma r(t)\right) \approx 1 - \frac \beta \gamma r(t) + \dfrac12\left(\dfrac\beta\gamma r(t)\right)^2.$$
Тогда, подставляя это приближение в выражение \eqref{drdt-1}, имеем обыкновенное дифференциальное уравнение Риккати 
\begin{equation}
	\label{drdt-2}
	\dfrac{\d r(t)}{\d t} \approx \gamma\cdot \left[1 + \left(\dfrac\beta\gamma s_0 - 1\right)r(t) - \dfrac{s_0\beta ^2}{2 \gamma ^2}r^2(t)\right].
\end{equation}
Уравнение \eqref{drdt-2} можно решить как уравнение с разделяющимися переменными, приведя его к виду 
$$\dfrac{\d r(t)}{\gamma\cdot \left[1 + \left(\dfrac\beta\gamma s_0 - 1\right)r(t) - \dfrac{s_0\beta ^2}{2 \gamma ^2}r^2(t)\right]} \approx \d t.$$
Проинтегрировав его и выполнив необходимые преобразования, можно получить решение в виде
\begin{equation}
	r(t)\approx \dfrac{\gamma^2}{\beta^2 s_0}\left[\dfrac{\beta}{\gamma}s_0 - 1 + Q \tanh \left(\dfrac 12Q \gamma t - \tanh^{-1}\dfrac{\frac \beta \gamma s_0 - 1}{Q} \right)\right],
\end{equation}
где $$Q = \sqrt{\left(\dfrac \beta \gamma s_0 - 1\right)^2 + 2s_0\dfrac{\beta^2}{\gamma^2}}.$$
Если ввести замены $$A = \dfrac{\gamma^3 Q^2}{2 s_0 \beta^2},\quad B = \dfrac{Q \gamma }{2},\quad \tanh \varphi = \dfrac{\frac \beta \gamma s_0 - 1}Q,$$
то можно записать приближенное равенство 
\begin{equation}
	\dfrac{\d r(t)}{\d t} \approx \dfrac{A}{\cosh^2 (Bt - \varphi)}.
\end{equation}
Таким образом, аналитическое решение даже классической SIR-модели строится сильно сложнее, чем для простейшей SI-модели. Также ясно, что точное решение для SIR-модели мы определить не сможем: любое построенное решение задачи Коши будет являться приближенным. Вследствие этого для SIR-моделей и их модификаций решения строятся с помощью численных методов. Поэтому при рассмотрении всех модификаций SIR-модели мы уже не будем останавливаться на построении аналитического решения, а будем ссылаться на возможность построения численного решения.
\subsection{Приближенное численное решение задачи Коши}
Ранее мы показали, что задача Коши \eqref{sir-1}, \eqref{constr} является корректно поставленной. А тогда для ее решения мы можем применять численные методы интегрирования обыкновенных дифференциальных систем.

Для того, чтобы построить приближенное численное решение задачи Коши 
\eqref{sir-1}, \eqref{constr}, можно использовать классические численные методы интегрирования обыкновенных дифференциальных уравнений. К примеру, метод Эйлера, методы Рунге-Кутты, методы предиктор-корректора.

В частности мы будем использовать пакет scipy из Python, в котором предложен алгоритм LSODE (алгоритм Ливермора для обыкновенных дифференциальных уравнений), который решает жесткие и нежесткие системы дифференциальных уравнений первого порядка. В нежестком случае используются методы Адамса (методы предиктор-корректора), а в жестком случае -- методы обратной дифференциации (BDF) (методы Гира). Линейные системы, которые возникают, решаются прямыми методами (LU-факторизация).

Таким образом, вдаваться в формальное представление итерационных алгоритмов численного решения мы не будем. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Расширения SIR-модели}\label{1sec:sir-modified}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
Все модели, которые мы далее будем рассматривать, основываются на классической SIR-модели, для которой мы описали формальный вывод задачи Коши, обосновали корректную постановку этой задачи Коши и исследовали методы решения этой задачи Коши. Поэтому для всех расширений SIR-модели мы не будем останавливаться на всех этих пунктах, а лишь опишем общую постановку задач Коши при конкретных модификациях классической модели. 
\subsection{SIS-модель}
Модель SIS (susceptible-infected-susceptible) основана на предположении, что лица, которые были инфицированы и вылечились, не приобрели
иммунитет. В этом случае они возвращаются в первую группу восприимчивых $S(t)$. Эта модель описывается следующей задачей Коши:
\begin{equation}
	\begin{dcases}
		\dfrac{\d S(t)}{\d t} = - \beta\cdot  S(t)\cdot I(t) + \gamma I(t),\\
		\dfrac{\d I(t)}{\d t} = \beta\cdot S(t)\cdot I(t) - \gamma I(t),\\
		S(0) = S_0,\ I(0) = I_0.
	\end{dcases}
\end{equation}
В первом уравнении системы описывается переход доли лиц, которые были инфицированы, из группы $S(t)$ в группу $I(t)$. Второе уравнение системы описывает переход
доли лиц из группы $I(t)$ снова в $S(t)$, т.е. лиц, которые были инфицированы, вылечились и не получили иммунитет. 

Схематически данный процесс представлен на Рис. 1.3

\begin{figure}[h!]
	\center{\includegraphics[scale=0.25]{images/img02}}
	
	\dfig{Схема перехода индивидов модели SIS}\label{fig3}
\end{figure}

\subsection{SIRD-модель}
Для описания некоторых инфекционных заболеваний необходимо рассматривать еще одну группу, описывающую долю умерших индивидов. Как правило, эта группа обозначается буквой $D$ (death), а вероятность перехода из группы $I$ в группу $D$ обозначим через $\mu$. Например, к уже описанной модели SIR добавим группу $D$ и получим модель SIRD, которая описывается следующей задачей Коши

\begin{equation}
	\begin{dcases}
		\dfrac {\d S(t)}{\d t} = -\beta \cdot S(t) \cdot I(t),\\
		\dfrac{\d I(t)}{\d t} = \beta \cdot S(t)\cdot I(t) - \gamma\cdot I(t) - \mu\cdot I(t),\\
		\dfrac{\d R(t)}{\d t} = \gamma\cdot I(t), \\
		\dfrac{\d R(t)}{\d t} = \mu\cdot I(t),\\
		S(0) = S_0,\ I(0) = I_0,\ R(0) = 0,\ D(0) = 0.
	\end{dcases}
\end{equation}

На Рис. 1.4
приведена схема данной модель. SIRD-модель отличается от классической SIR-модели тем, что инфицированные индивиды могут вылечиться и получить иммунитет с вероятностью $\gamma$ или могут умереть с вероятностью $\mu$. [5]

\begin{figure}[h!]
	\center{\includegraphics[scale=0.25]{images/img03}}
	
	\dfig{Схема перехода индивидов модели SIRD}\label{fig4}
\end{figure}

\subsection{SIRS-модель}
Модель SIRS (Susceptible-Infected-Recovered-Susceptible) является вариацией модели SIR, которая учитывает возможность повторного заражения после выздоровления (потери иммунитета). В модели SIRS существует циклическое движение между группами подверженных $S$, инфицированных $I$ и восстановленных $R$. Эта модель описывается задачей Коши
\begin{equation}
	\begin{dcases}
		\dfrac {\d S(t)}{\d t} = -\beta \cdot S(t) \cdot I(t) + \lambda \cdot R(t),\\
		\dfrac{\d I(t)}{\d t} = \beta \cdot S(t)\cdot I(t) - \gamma\cdot I(t),\\
		\dfrac{\d R(t)}{\d t} = \gamma\cdot I(t) - \lambda \cdot R(t),\\
		S(0) = S_0,\ I(0) = I_0,\ R(0) = 0.
	\end{dcases}
\end{equation}
где число $\lambda$ определяет вероятность потери иммунитета и перехода из группы $R(t)$ в группу $I(t)$. [2]

Схематически эту модель можно представить следующим образом (Рис. 1.5)

\begin{figure}[h!]
	\center{\includegraphics[scale=0.25]{images/img07}}
	
	\dfig{Схема перехода индивидов модели SIRS}\label{fig5}
\end{figure}

Модель SIRS позволяет изучать повторные вспышки болезни в популяции, так как люди, выздоровевшие от инфекции, могут снова стать подверженными и инфицироваться. Это особенно важно для изучения болезней, которые не обеспечивают долгосрочный иммунитет, например, грипп или коронавирусные инфекции.

\subsection{Модели с учетом смертности и рождаемости особей}
Для моделирования процессов распространения инфекционных заболеваний в длительные периоды времени необходимо учитывать процессы рождаемости и смертности.

Пусть $\lambda = \operatorname{const} > 0$ и $\mu = \operatorname{const} > 0$ -- это коэффициенты рождаемости и смертности популяции соответственно. Задача Коши для описания SIR-модели в предположении, что все рожденные являются здоровыми людьми, имеет вид 
\begin{equation}
	\begin{dcases}
		\dfrac {\d S(t)}{\d t} = -\beta \cdot S(t) \cdot I(t) + \lambda\cdot N(t) - \mu\cdot S(t),\\
		\dfrac{\d I(t)}{\d t} = \beta \cdot S(t)\cdot I(t) - \gamma\cdot I(t) - \mu\cdot I(t),\\
		\dfrac{\d R(t)}{\d t} = \gamma\cdot I(t) - \mu \cdot R(t),\\
		S(0) = S_0, \ I(0) = I_0,\ R(0) = 0.
	\end{dcases}
\end{equation}
где $$S(t) + I(t) + R(t) = N(t),$$ причем заметим, что теперь численность популяции -- это функция $N = N(t)$, то есть она непостоянная (за счет рождаемости и смертности людей). [5]

Складывая все уравнения системы, мы получаем уравнение Мальтуса для численности популяции 
\begin{equation}
	\dfrac{\d N(t)}{\d t} = (\lambda-\mu) \cdot N(t).
\end{equation}

Анализируя поведение $I'(0)$, можно определить базовое репродуктивное число. Для отсутствия эпидемии необходимо, чтобы $$\beta S_0 - \gamma - \mu < 0 \quad \text{или}\quad \beta \dfrac{S_0}{\Lambda+\mu} < 1.$$
Следовательно имеем базовое репродуктивное число для расширенной модели $$R_0 = \beta \cdot \dfrac{S_0}{\Lambda+\mu}.$$ Обратим внимание на то, что коэффициент рождаемости не влияет на пороговый
эффект. Расширенная SIR-модель с учетом рождаемости и смертности может иметь колеблющиеся решения.

\subsection{SEIR-модель, или модель с учетом инкубационного периода}
Очень часто стандартная модель SIR является слишком простой и
нереалистичной, так как в ней полагается, что особь является заразной сразу же после инфицирования. В SEIR модели предполагается, что инфекция имеет инкубационный период, в течение которого люди инфицированы, но
еще не заразны. Эта группа людей обозначается через $E$ (exposed). С учетом нового класса получаем следующую структуру
популяции:
$$S + E + I + R = N,$$ где
\begin{itemize}
	\item $S(t)$ -- это количество не инфицированных людей. Причем скорость изменения количества подверженных зависит от вероятности передачи инфекции, количества инфицированных и количества подверженных, где $\beta$ -- это скорость передачи заболевания;
	\item $E(t)$ -- это число инфицированных, но еще не заразных людей. Причем скорость изменения количества инфицированных, но еще не заразных людей зависит от входящего потока людей, проходящих инкубационный период, а также выходящего потока этих же людей. Параметр $\sigma^{-1}$ представляет собой среднюю продолжительность инкубационного периода;
	\item $I(t)$ -- это количество инфицированных людей. Причем	скорость изменения количества инфицированных зависит от входящего потока инфицированных и выходящего потока инфицированных. Параметр $\gamma$ -- это скорость восстановления;
	\item $R(t)$ -- это группа выздоровевших лиц, а именно людей, которые восстановились.
\end{itemize}
Модель SEIR описывается задачей Коши
\begin{equation}
	\begin{dcases}
		\dfrac {\d S(t)}{\d t} = - \beta \cdot I(t)\cdot S(t),\\
		\dfrac {\d E(t)}{\d t} = \beta \cdot S(t)\cdot I(t) - \sigma\cdot E(t),\\
		\dfrac{\d I(t)}{\d t} =\sigma \cdot E(t) - \gamma\cdot I(t),\\
		\dfrac{\d R(t)}{\d t} = \gamma\cdot I(t),\\
		S(0) = S_0,\ I(0) = I_0,\ E(0) = 0,\ R(0) = 0.
	\end{dcases}
\end{equation}

Схематически эта модель может быть записана в следующем виде (Рис. 1.6)

\begin{figure}[h!]
	\center{\includegraphics[scale=0.25]{images/img08}}
	
	\dfig{Схема перехода индивидов модели SEIR}\label{fig6}
\end{figure}

Также имеет место модель SEIR с учетом смертности и рождаемости особей, которая описывается задачей Коши
\begin{equation}
	\begin{dcases}
		\dfrac {\d S(t)}{\d t} = \lambda N(t) - (\beta \cdot I(t) +\mu)\cdot S(t),\\
		\dfrac {\d E(t)}{\d t} = \beta \cdot S(t)\cdot I(t) - (\mu + \sigma)\cdot E(t),\\
		\dfrac{\d I(t)}{\d t} =\sigma \cdot E(t) - (\mu + \gamma)\cdot I(t),\\
		\dfrac{\d R(t)}{\d t} = \gamma\cdot I(t) - \mu \cdot R(t),\\
		S(0) = S_0,\ I(0) = I_0,\ E(0) = 0,\ R(0) = 0.
	\end{dcases}
\end{equation}


Важно отметить, что модель SEIR является упрощенной моделью и не учитывает множество реальных факторов, таких как вакцинация, мутации вируса и изменение поведения людей. Но она предоставляет базовый фреймворк для изучения распространения инфекции и позволяет прогнозировать общую динамику эпидемии.
Именно на примере этой модели мы и будем проводить эксперименты в главе 3.

Дополнительные вариации модели SEIR также могут включать дополнительные факторы, такие как иммунизация или введение противоэпидемических мер. Модель SEIR и ее вариации широко используются в исследованиях эпидемиологии и планировании общественного здравоохранения. Они позволяют ученым и решающим органам оценить различные стратегии контроля эпидемии, такие как вакцинация, социальное дистанцирование, использование масок и карантинные меры. Такие модели могут помочь прогнозировать будущие тенденции распространения болезни и определить наиболее эффективные меры по сдерживанию инфекции.

\subsection{MSIR-модель}
Модель MSIR (M — «maternally derived immunity») включает класс $M(t)$ (для материнского иммунитета) в начало модели. При многих инфекциях, включая корь, младенцы рождаются невосприимчивыми к этому заболеванию, но в течение первых нескольких месяцев жизни обладают иммунитетом к этому заболеванию благодаря защите от материнских антител (которые передаются через плаценту и дополнительно через молозиво). Это называется пассивным иммунитетом. Эту дополнительную деталь можно продемонстрировать, включив в начало модели класс $M(t)$ (для иммунитета, передающегося по материнской линии). 

Модель MSIR мы будем строить на основе модели с учетом смертности и рождаемости. Тогда модель MSIR описывается следующей задачей Коши
\begin{equation}
	\begin{dcases}
		\dfrac {\d M(t)}{\d t} = \lambda \cdot N(t) - \delta\cdot M(t)-\mu\cdot M(t),\\
		\dfrac {\d S(t)}{\d t} = \delta \cdot M(t) -\beta\cdot S(t)\cdot I(t) - \mu \cdot S(t),\\
		\dfrac{\d I(t)}{\d t} =\beta\cdot S(t)\cdot I(t) - \gamma \cdot I(t) - \mu \cdot I(t),\\
		\dfrac{\d R(t)}{\d t} = \gamma\cdot I(t) - \mu \cdot R(t),\\
		M(0) = M_0,\ S(0) = S_0,\ I(0) = I_0,\ R(0) = 0.
	\end{dcases}
\end{equation}
где, $\delta$ -- это вероятность потери материнского иммунитета, $\lambda$ и $\mu$ -- это коэффициенты рождаемости и смертности популяции соответственно и $$S(t) + I(t) + R(t) = N(t).$$

Схематически эта модель может быть записана в следующем виде (Рис. 1.7)

\begin{figure}[h!]
	\center{\includegraphics[scale=0.25]{images/img09}}
	
	\dfig{Схема перехода индивидов модели MSIR}\label{fig7}
\end{figure}

\subsection{MSEIR-модель}
Теперь усложним модель SEIR с учетом смертности и рождаемости особей, добавив к ней материнский иммунитет. Таким образом, получается модель MSEIR.
Модель MSEIR ($M$ -- наделенные иммунитетом от рождения, $S$ -- восприимчивые, $E$ -- контактные, $I$ -- инфицированные, $R$ -- выздоровевшие) -- одна из самых сложных для анализа в силу наличия большого числа независимых параметров. Задача Коши для нее имеет вид
\begin{equation}
	\begin{dcases}
		\dfrac {\d M(t)}{\d t} = \lambda \cdot N(t) - \delta\cdot M(t)-\mu\cdot M(t),\\
		\dfrac {\d S(t)}{\d t} = \delta \cdot M(t) -\beta\cdot S(t)\cdot I(t) - \mu \cdot S(t),\\
		\dfrac {\d E(t)}{\d t} = \beta \cdot S(t)\cdot I(t) - (\sigma + \mu)\cdot E(t),\\
		\dfrac{\d I(t)}{\d t} =\sigma \cdot E(t) - (\gamma + \mu)\cdot I(t),\\
		\dfrac{\d R(t)}{\d t} = \gamma\cdot I(t) - \mu \cdot R(t),\\
		M(0) = M_0,\ S(0) = S_0,\ I(0) = I_0,\ E(0) = 0,\ R(0) = 0.
	\end{dcases}
\end{equation}
где $M (t)$ -- численность индивидов с приобретенным внутриутробно иммунитетом. От ранее рассмотренных моделей эта система отличается тем, что учитывает рождение детей, вероятность заражения которых растет со временем по мере утраты ими иммунитета, приобретенного внутриутробно. Эти зависимости описаны в первых двух уравнениях системы. [5]

Схематически эта модель может быть записана следующим образом (Рис. 1.8)

\begin{figure}[h!]
	\center{\includegraphics[scale=0.25]{images/img10}}
	
	\dfig{Схема перехода индивидов модели MSEIR}\label{fig8}
\end{figure}

Таким образом, в зависимости от условия протекания эпидемии мы можем модифицировать базовую SIR-модель, добавляя к ней новые группы или изменяя условия переходов из одной группы в другую. Эта универсальность позволяет учитывать множество факторов, влияющих на распространение болезни. Однако стоит также учитывать, что, добавляя новые факторы и группы, модель становится сильно сложнее. Это можно было наблюдать при сравнении SI и SIR моделей, когда, добавив одну новую группу, мы утратили возможность строить аналитическое решение дифференциальной системы.