\chapter[МОДЕЛИРОВАНИЕ ПРОЦЕССА РАСПРОСТРАНЕНИЯ ГРИППА]{МОДЕЛИРОВАНИЕ ПРОЦЕССА РАСПРОСТРАНЕНИЯ ГРИППА}\label{chap3}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Постановка практической задачи}\label{3sec:practical-task}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Сформулируем практическую задачу. Необходимо смоделировать процесс распространения гриппа. Для этого нам нужно собрать всю необходимую для моделирования информацию о распространении гриппа.

Грипп -- это острое респираторное вирусное заболевание, вызываемое вирусами гриппа и поражающее в первую очередь верхние дыхательные пути, а также бронхи и, в более редких случаях, -- лёгкие. Выделяется среди острых респираторных вирусных инфекций у людей из-за возможного тяжёлого течения болезни. Грипп ассоциируется с высокой смертностью во время пандемий, эпидемий и спорадических вспышек. Пандемии гриппа случаются примерно каждые 50 лет, эпидемии же наблюдаются чаще. Вспышки сезонного гриппа ежегодно происходят почти во всём мире. Наиболее частой причиной сезонного гриппа являются вирусы гриппа A, также только эти вирусы гриппа известны как причина пандемий.

Симптомы гриппа появляются на 1—4-й день после заражения и включают в себя лихорадку, кашель, головную боль, боль в мышцах и суставах, слабость, боль в горле и насморк. При этом кашель может длиться две и более недели. Наиболее заразен больной на 3—4-й день с момента появления симптомов. Реконвалесцентный период составляет 7—15 дней.[7] После выздоровления формируется иммунитет к конкретному штамму вируса, но он не защищает от других штаммов. Иммунитет носит временный характер (обычно до 1-2 лет).

Индекс репродукции ($R_{0}$, в медицинской литературе часто базовое репродуктивное число; также базовый показатель репродукции) -- это безразмерный параметр, характеризующий заразность инфекционного заболевания в медицинской и ветеринарной эпидемиологии. Обычно определяется как количество людей, которые будут заражены типичным заболевшим, попавшим в полностью неиммунизированное окружение при отсутствии специальных эпидемиологических мер, направленных на предотвращение распространения заболевания (например, карантина). Если $R_0 > 1$. то на начальном этапе число заболевших будет расти экспоненциально.[8]

Для гриппа будем считать, что базовое репродуктивное число для гриппа 0.9-2.1. Тогда в качестве базового репродуктивного числа возьмем среднее значение $$R_0 = 1.5.$$

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Применение детерминированной SEIR модели для моделирования}\label{3sec:determ-seir}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

На основе приведенной информации о распространении можем сформулировать математическую модель следующим образом. Так как симптомы появляются через 1-4 дня, то возьмем средний инкубационный период для модели $T_\text{инкубац} = 2$ дня. Тогда коэффициент перехода из $E$ в $I$ равна
$$\sigma = \dfrac{1}{T_\text{инкубац}} = \dfrac 1 2 = 0.5.$$
Средний инфекционный период выберем $T_\text{инфекц}=5$ дней.
Тогда коэффициент выздоровления равен
$$\gamma = \dfrac{1}{T_\text{инфекц}} = \dfrac 1 5 = 0.2.$$
Коэффициент передачи инфекции $\beta$ мы можем получить из  базового репродуктивного числа через следующее соотношение
$$\beta = R_0\cdot \gamma = 1.5\cdot 0.2 = 0.3.$$

В качестве числа населения возьмем $N=1000$, а число инфицированных зададим равное $I_0 = 20$. Отсюда $S_0 = N - I_0 = 980$. Данный процесс будем рассматривать в течение $T=100$ дней.

Таким образом, мы можем описать процесс распространения гриппа с помощью классической SEIR модели
\begin{equation*}
	\begin{dcases}
		\dfrac {\d S(t)}{\d t} = - 0.3 \cdot I(t)\cdot S(t),\\
		\dfrac {\d E(t)}{\d t} = 0.3 \cdot S(t)\cdot I(t) - 0.5\cdot E(t),\\
		\dfrac{\d I(t)}{\d t} =0.5 \cdot E(t) - 0.2\cdot I(t),\\
		\dfrac{\d R(t)}{\d t} = 0.2\cdot I(t),\\
		S(0) = 980,\ I(0) = 20,\ E(0) = 0,\ R(0) = 0.
	\end{dcases}
\end{equation*} 

Приведем график численного решения поставленной задачи Коши (Приложение 1)

\begin{figure}[h!]
	\center{\includegraphics[width=\textwidth]{images/graph01}}
	
	\dfig{График численного решения задачи Коши для детерминированной SEIR модели}\label{graph01}
\end{figure}

Из графика видно, как сперва число здоровых людей начинает стремительно уменьшатся, пока не достигает грани в 400. Число выздоровевших же напротив начинает стремительно возрастать, пересекается с график числа здоровых людей на 60-ый день, а затем скорость становится все ниже и ниже, пока не достигается грань в 600 человек. Как можно видеть, через 100 дней после начала эпидемии число болеющих практически снизилось до нуля. То есть мы можем заключить, что приблизительно спустя 100 дней эпидемия прекратилась.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Применение вероятностной SEIR модели для \\ моделирования}\label{3sec:probability-seir}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

В соответствии с п.2.1.1 построим вероятностную модель с дискретным временем, поскольку для нее легко привести численную реализацию. Вероятностная SEIR-модель для гриппа имеет следующий вид
\begin{equation}
	\begin{dcases}
		S_{t+1} = S_t - \Delta E_t,\\
		E_{t+1} = E_t +\Delta E_t - \Delta I_t,\\
		I_{t+1} = I_t + \Delta I_t - \Delta R_t,\\
		R_{t+1} = R_t + \Delta R_t,
		S_0 = 980,\ E_0 = 0,\ I_0 = 20,\ \ R_0 = 0
	\end{dcases}
	t = 0,1,2\ldots,
\end{equation}
при этом
$$\Delta E_t \sim \Binom\left(S_t, 
1 - \exp\left(-\beta\cdot  \frac{I}{N} \cdot \Delta t\right)\right),$$
$$\Delta I_t \sim \Binom\left(E_t, 1 - \exp\left(-\sigma \cdot \Delta t\right)\right),$$
$$\Delta R_t \sim \Binom\left(I_t, 1 - \exp\left(-\gamma \cdot \Delta t\right)\right).$$

Таким образом, мы можем описать процесс распространения гриппа с помощью вероятностной SEIR модели. Приведем 100 реализаций этой модели, а в качестве результирующего графика выберем средние значения для каждой группы, а также приведем 95\%-доверительные интервалы для каждой переменной (Приложение 2)

\begin{figure}[h!]
	\center{\includegraphics[width=\textwidth]{images/graph02}}
	
	\dfig{График численной реализация вероятностной SEIR для гриппа с доверительными интервалами}\label{graph02}
\end{figure}

Из графика видно, что поведения функций, описывающих группы людей, не сильно изменились относительно детерминированного случая. Однако теперь сместились границы, при которых число восприимчивых людей перестает снижаться, а число выздоровевших -- расти. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Применение пространственной SEIR модели для моделирования}\label{3sec:dimension-seir}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Для пространственной модели построим сетку узлов $30 \times 30$ на которой зададим вероятностную SEIR-модель для дискретного времени с сохранением всех параметров из предыдущего случая. Клетки, в которых будут находиться инфицированные люди, будут выбираться случайно.

Таким образом, мы можем описать процесс распространения гриппа с помощью вероятностной SEIR-модели в пространстве. Приведем на графике одну из реализаций через каждые 10 дней (Приложение 3)

\begin{figure}[h!]
	\center{\includegraphics[width=\textwidth]{images/graph03}}
	
	\dfig{Пространственные графики численной реализации вероятностной SEIR модели для гриппа}\label{graph03}
\end{figure}

Из построенных графиков видно, что, как и в предыдущих случаях, спустя 30-40 дней число инфицированных особей достигает своего пика, а затем стремительно снижается до такой степени, что уже на 90-ый день число инфицированных стремится к нулю. Кроме этого также заметно, как все эти изменения отражаются в пространстве.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Применение мультиагентной SEIR модели для моделирования}\label{3sec:multiagent-seir}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Алгоритм моделирует распространение инфекции в популяции агентов, используя модифицированную модель SEIR (восприимчивые, экспонированные, инфицированные, выздоровевшие). Популяция агентов размещена в двумерном пространстве, и их поведение включает перемещение, заражение и смену состояния в зависимости от времени и контактов с другими агентами. Графики показывают динамику агентов на разных временных шагах.

\subsubsection*{Шаг 1}

На первом этапе создаётся популяция агентов с заданными свойствами:

\begin{itemize}
	\item {Количество агентов ($N_{\text{agents}}$)}: Всего агентов в симуляции.
	\item {Позиции агентов}: Каждый агент случайным образом размещается в двумерном пространстве размера $L \times L$.
	\item {Индивидуальные параметры агентов}: Для каждого агента задаются случайные значения:
	\begin{itemize}
		\item {Восприимчивость ($\text{susceptibility}$)}: Коэффициент, влияющий на вероятность заражения.
		\item {Интенсивность контактов ($\text{contact\_rate}$)}: Сколько контактов совершает агент.
		\item {Инкубационный период ($\text{incubation\_period}$)}: Время, необходимое для перехода из состояния <<Экспонированный>> (E) в <<Инфицированный>> (I).
		\item {Инфекционный период ($\text{infectious\_period}$)}: Время, через которое инфицированный агент выздоравливает.
	\end{itemize}
	\item {Начальное состояние}: Большинство агентов находятся в состоянии <<Восприимчивые>> (S). Несколько агентов (определяется параметром\\ initial\_infected) изначально заражены (I).
\end{itemize}

\subsubsection*{Шаг 2}

На каждом временном шаге ($T$) выполняются следующие действия для обновления состояния агентов:

\begin{enumerate}
	\item Перемещение агентов
	\begin{itemize}
		\item Каждый агент с заданной вероятностью ($\text{move\_prob}$) перемещается случайным образом в пределах пространства.
		\item Если агент выходит за границы пространства, его позиция корректируется (ограничивается рамками пространства $L \times L$).
	\end{itemize}
	\item Обновление состояния агента
	\begin{itemize}
		\item {Если агент в состоянии <<Экспонированный>> (E)}:
		\begin{itemize}
			\item Увеличивается таймер заражения ($\text{time\_infected}$).
			\item Если время заражения превышает инкубационный период, агент переходит в состояние <<Инфицированный>> (I).
		\end{itemize}
		\item {Если агент в состоянии <<Инфицированный>> (I)}:
		\begin{itemize}
			\item Также увеличивается таймер заражения ($\text{time\_infected}$).
			\item Если таймер превышает инфекционный период, агент переходит в состояние <<Выздоровевший>> (R).
		\end{itemize}
	\end{itemize}
	\item Заражение других агентов
	\begin{itemize}
		\item Если агент находится в состоянии <<Инфицированный>> (I), он может заразить других агентов, находящихся рядом (расстояние меньше 0.5).
		\item Вероятность заражения определяется формулой:
		\[
		P_{\text{infect}} = \beta \cdot \text{susceptibility},
		\]
		где $\beta$~--- коэффициент передачи инфекции.
		\item Если случайное число меньше $P_{\text{infect}}$, агент в состоянии <<Восприимчивый>> (S) переходит в состояние <<Экспонированный>> (E), и его таймер заражения сбрасывается.
	\end{itemize}
\end{enumerate}

\subsubsection*{Шаг 3}

Каждые 10 временных шагов (или другой заданный интервал) сохраняется:
\begin{itemize}
	\item Текущее состояние всех агентов.
	\item Время ($t$), соответствующее этому состоянию.
\end{itemize}

Эти данные используются для построения графиков.

\subsubsection*{Шаг 4}

Создаётся сетка из графиков, отображающих положение агентов в пространстве на разных временных шагах. Каждый график отражает состояние популяции в конкретный момент времени.

{Цветовое кодирование состояния агентов}:
\begin{itemize}
	\item {Синий (S)}~--- восприимчивые агенты.
	\item {Оранжевый (E)}~--- экспонированные агенты.
	\item {Красный (I)}~--- инфицированные агенты.
	\item {Зелёный (R)}~--- выздоровевшие агенты.
\end{itemize}

\subsubsection*{Используемые параметры и их влияние}

\begin{itemize}
	\item {$N_{\text{agents}}$}~--- количество агентов:
	\begin{itemize}
		\item Чем больше агентов, тем плотнее популяция, что может ускорить распространение инфекции.
	\end{itemize}
	\item \textbf{$L$}~--- размер пространства:
	\begin{itemize}
		\item Чем больше пространство, тем сложнее агентам контактировать, что замедляет заражение.
	\end{itemize}
	\item \textbf{$\beta$}~--- коэффициент передачи:
	\begin{itemize}
		\item Определяет вероятность заражения при контакте. Чем выше, тем быстрее распространяется инфекция.
	\end{itemize}
	\item {$\sigma_{\text{mean}}$ и $\gamma_{\text{mean}}$}~--- инкубационный и инфекционный периоды:
	\begin{itemize}
		\item Увеличение этих параметров замедляет переход между состояниями, что влияет на динамику эпидемии.
	\end{itemize}
	\item {$\text{move\_prob}$}~--- вероятность перемещения агентов:
	\begin{itemize}
		\item Чем больше значение, тем чаще агенты перемещаются, что увеличивает вероятность контактов и заражения.
	\end{itemize}
	\item {$\text{initial\_infected}$}~--- начальное число заражённых:
	\begin{itemize}
		\item Определяет начальный уровень инфекции. Чем больше заражённых в начале, тем быстрее эпидемия распространяется.
	\end{itemize}
\end{itemize}

Приведем графический результат работы алгоритма

\begin{figure}[h]
	\center{\includegraphics[scale=0.3]{images/graph04}}
	
	\dfig{Графическое представление реализации мультиагентной SEIR модели}\label{graph04}
\end{figure}

Таким образом, можно заметить, что теперь процесс распространения гриппа протекает иначе. Основной пике был между 10-ым и 20-ым днями, а далее после 60-го дня грипп не распространялся, то есть распространение прекратилось. Можно сделать выводы, что наличие у каждого индивида особых собственных свойств сильно сказывается на процессе распространения заболевания.