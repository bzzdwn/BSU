\chapter{МНОГОМЕРНЫЕ МОДЕЛИ И МЕТОДЫ \\АНАЛИЗА ПО ДАННЫМ СМЕШАННОЙ ЧАСТОТЫ}\label{chap2}


В настоящей главе приводится формальное описание моделей, используемых для решения задачи прогнозирования. Приводятся классификации моделей векторных авторегрессий и их свойства. Объясняется метод оценки точности построенных моделей.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section[Модель векторной авторегрессии VAR и ее применение в задачах макроэкономического анализа]{Модель векторной авторегрессии VAR и ее \\применение в задачах макроэкономического \\анализа}\label{sec:vector-autoregression}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Векторная авторегрессия обычно используется в эконометрике для прогнозирования систем со взаимосвязанными
временными рядами и для анализа динамического воздействия случайных возмущений на систему
переменных. Данный подход позволяет 
рассматривать каждую эндогенную переменную в системе как функцию от всех
эндогенных переменных в системе с их лагами до порядка $p$.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% 

\subsection{Определение модели векторной авторегрессии}\label{subsec:var}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Пусть задан вектор временных рядов 
\begin{equation*}
	\mathbf y_t = \begin{pmatrix}
		y_{t,1} \\ \vdots \\ y_{t,n}
	\end{pmatrix},\ t = 1,\ldots, T,
\end{equation*}
где $y_{i,t}$, $i =1,\ldots, n$ -- это $i$-ый временной ряд, соответствующий конкретному макроэкономическому показателю, $t$ -- время. Введем векторные параметры
\begin{equation*}
	\boldsymbol \beta_0 = \begin{pmatrix}
		\beta_{0,1} \\ \vdots \\ \beta_{0, n}
	\end{pmatrix},\ \beta_{0, i} \in \mathbb R,\ i=1,\ldots,n,
\end{equation*}
\begin{equation*}
	\mathbf B_j = \begin{pmatrix}
		\beta_{j, 11} & \ldots & \beta_{j, 1n} \\
		\vdots & \ddots & \vdots \\
		\beta_{j, n1} & \ldots & \beta_{j, nn}
	\end{pmatrix},\ \beta_{j, ik} \in \mathbb R,\ i,k = 1,\ldots,n,\ \forall j
\end{equation*}
и вектор шумов
\begin{equation*}
	\boldsymbol \epsilon_t = \begin{pmatrix}
		\epsilon_{t,1} \\ \vdots \\ \epsilon_{t,n}
	\end{pmatrix},\ \epsilon_{t,i} \sim WN(0,\sigma^2),\ i = 1,\ldots, n,
\end{equation*}
где $WN(0,\sigma^2)$ -- это белый шум со средним 0 и дисперсией $\sigma^2$.
Тогда модель \textit{векторной авторегрессии порядка $p$} (\textit{Vector AutoRegression}, VAR) можно записать в виде
\begin{equation}\label{eq:var}
	\mathbf y_t = \boldsymbol \beta_0 + \sum_{j=1}^{p}\mathbf B_j\mathbf y_{t-j} + \boldsymbol\epsilon_t.
\end{equation}
Причем для вектора шоков отсутствует серийная корреляция 
\begin{equation*}
	\corr (\epsilon_{t,i}, \epsilon_{s,i}) = 0,\ t\ne s,
\end{equation*} 
и допускается кросс-корреляция 
\begin{equation*}
	\corr(\epsilon_{t,i}, \epsilon_{t,j}),\ i \ne j.
\end{equation*}

Если в уравнении \eqref{eq:var} обозначить
\begin{equation*}
	\mathbf B(z) = \mathbf E - z\mathbf B_1 -\ldots - z^p \mathbf B_p,
\end{equation*}
где $\mathbf E$ -- это единичная матрица размерности $n\times n$, то критерий стационарности авторегрессионной модели для многомерного случая определяется следующим образом:
все корни уравнения \begin{equation}
	\det \mathbf B(z) = 0
\end{equation}
должны быть по модулю больше единицы.

Для определения количества лагов $p$ применяются многомерные аналоги информационных критериев Акаике, Шварца, Хеннана-Куина, а для оценки коэффициентов авторегрессии $\mathbf B_j$, $j=1,\ldots,p$  применяется метод наименьших квадратов.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Причинность по Грейнджеру}\label{subsec:granger}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Эмпирический анализ часто затрудняет выявление причинно-следственных связей. Даже при наличии сильной корреляции между переменными, без дополнительной информации невозможно точно установить причины их взаимного влияния. Иногда экономическая теория позволяет установить взаимосвязь между переменными. Но в случаях, когда экономической теории недостаточно или же она дает неоднозначный ответ, VAR модель дает возможность определить причинность переменных, то есть обнаружить как изменение одних переменных предшествует изменению других, основываясь только на статистических результатах

Если рассматривать два фактора $x$ и $y$, то под причинностью понимается следующее:
если переменная $x$ влияет на переменную $y$, то это означает, что $y$ меняется
либо мгновенно, либо через короткое время после изменения $x$. Или наоборот, если $x$ не является причиной
изменения $y$, то изменения $x$ не влияют на будущие значения $y$.

Пусть $\{y_t\}$, $\{x_t\}$ -- временные ряды, $t\in T$. Построим для них VAR($p$) модель
\begin{align*}
	x_t = \mu_1 + \sum_{j=1}^{p} \alpha_j x_{t-j} + \sum_{j=1}^{p} \beta_j y_{t-j} + u_t,\\
	y_t = \mu_2 + \sum_{j=1}^{p} \gamma_j x_{t-j} + \sum_{j=1}^{p} \delta_j y_{t-j} + v_t,
\end{align*} 
где $u_t,v_t\sim WN(0,\sigma^2)$, а $\alpha_j,\beta_j,\gamma_j,\delta_j \in \mathbb R$ -- это некоторые коэффициенты, которые определяются по методу наименьших квадратов. Для этой модели тестируются две гипотезы
\begin{align*}
	H_0' : \beta_1=\ldots = \beta_p =0,\\
	H_0'' : \gamma_1 = \ldots = \gamma_p = 0.
\end{align*}
Тогда $x_t$ является причиной по Грейнджеру для $y_t$, если $H_0'$ не отвергается, а $H_0''$ отвергается. И наоборот, $y_t$ является причиной по Грейнджеру для $x_t$, если $H_0''$ не отвергается, а $H_0'$ отвергается.

Важно понимать, что причинность по Гренджеру не означает наличие причинно-следственной связи, но отсутствие причинности по Гренджеру подтверждает отсутствие причинно-следственной связи.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Функция импульсных откликов}\label{subsec:irf}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

В общем случае коэффициенты VAR модели не имеют экономической интерпретации. Вследствие этого принято рассматривать \textit{функции импульсных откликов} (impulse response function, IRF) как описание влияния экзогенного шока на показатели.
Функция импульсного отклика задает траекторию по $h$, которую описывает $y_{t+h}$, инициированная единичным шоком $\epsilon_{t}$.

Сперва рассмотрим модель AR(1)
\begin{equation}
	y_t = \beta y_{t-1} + \epsilon_t,\ \epsilon_t \sim WN(0,\sigma^2),\ \beta \in \mathbb R.
\end{equation}
Ее можно представить в виде модели скользящего среднего порядка $+\infty$
\begin{equation}
	\label{eq:ma-infty}
	y_t = \beta y_{t-1} + \epsilon_t = \beta\cdot (\beta y_{t-2} + \epsilon_{t-1}) + \epsilon _t = \ldots = \sum_{j=0}^{+\infty} \beta^j \epsilon_{t-j}.
\end{equation}
Тогда из этого представления видно, что если задать единичный шок
\begin{equation*}
	\epsilon_0 = 0,\ \epsilon_1 = 1,\ \epsilon_2 = 0,\ldots, \epsilon_j = 0,\ldots
\end{equation*} 
то в соответствии с выражением \eqref{eq:ma-infty}
\begin{equation*}
	\begin{gathered}
		y_0 = \epsilon_0 = 0,\\
		y_1 = \epsilon_1 + \beta\epsilon_0 = 1,\\
		y_2 = \epsilon_2 + \beta \epsilon_1 + \beta^2 \epsilon_0 = \beta,\\
		\vdots\\
		y_j = \beta^j,\\
	\end{gathered}
\end{equation*}
и так далее. Таким образом, для одномерной модели AR(1) функция импульсного отклика -- это то же самое, что и представление в виде модели скользящего среднего порядка $+\infty$.

Формально функция импульсного отклика для VAR модели -- это матричная функция от $h=0,1,2,\ldots$, которая задается как
\begin{equation}
	\dfrac{\partial \mathbf y_{t+h}}{\partial \mathbf \epsilon_t} = \left(\dfrac{\partial y_{i, t+h}}{\partial \epsilon_{j,t}}\right)_{p\times p}
\end{equation}
Таким образом, элемент $(i,j)$ этой матричной функции отражает реакцию переменной $y_i$ на единичное изменение шока в переменной $y_j$ в момент времени $t+h$. В итоге функция импульсного отклика для конкретной переменной $y_i$ на шок в переменной $y_j$ задается последовательностью
\begin{equation*}
	\dfrac{\partial y_{i,t}}{\partial \epsilon_{j,t}},\ \dfrac{\partial y_{i,t+1}}{\partial \epsilon_{j,t}},\ \ldots,\ \dfrac{\partial y_{i,t+h}}{\partial \epsilon_{j,t}}, \ldots
\end{equation*}

Рассмотрим модель VAR(1)
\begin{equation}
	\mathbf y_t = \mathbf B \mathbf y_{t-1} + \boldsymbol \epsilon_t
\end{equation}
в соответствии с обозначениями \eqref{eq:var}. Эту модель также можно представить в виде векторной модели скользящего среднего
\begin{equation*}
	\mathbf y_t = \mathbf B \mathbf y_{t-1} + \boldsymbol \epsilon_t = \mathbf B (\mathbf B \mathbf y_{t-2} + \boldsymbol \epsilon_{t-1}) + \boldsymbol \epsilon_t = \ldots = \sum_{j=0}^{\infty} \mathbf B^j \boldsymbol \epsilon_{t-j}.
\end{equation*}
Тогда
\begin{equation}\label{eq:vma}
	\mathbf y_{t+h} = \sum_{j=0}^{\infty} \mathbf B^j \boldsymbol \epsilon_{t+h-j},
\end{equation}
откуда
\begin{equation}
	\dfrac{\partial y_{t+h}}{\partial \epsilon_{j,t}} = \dfrac{\partial}{\partial \epsilon_{j,t}} \left(\sum_{j=0}^{\infty} \mathbf B^j \boldsymbol \epsilon_{t+h-j}\right) = \mathbf B^h e_j,
\end{equation}
где $e_j$ -- это $j$-ый столбец единичной матрицы размерности $p\times p$.
Таким образом, элемент $\beta_{ij, h}$ в матрице $\mathbf  B^h$ описывает отклик переменной $y_{i,t}$ через $h$ шагов в будущем на единичный шок $\epsilon_{j,t}$. 

Возможны случаи, когда шоки $\epsilon_t$ коррелированны. Тогда мы не можем рассуждать о рассматриваемых шоках как об изолированных, поскольку в силу корреляции
будет наблюдаться мгновенное воздействие на все другие элементы вектора. Поэтому, с учетом этих единовременных эффектов, рассматриваются ортогонализированные функции импульсного отклика, например, через разложение Холецкого.

Пусть $\boldsymbol \Sigma$ -- это ковариационная матрица ошибок. Тогда, используя разложение Холецкого, ее можно представить в виде
\begin{equation}
	\boldsymbol \Sigma = \mathbf P\cdot \mathbf P^T.
\end{equation}
Тогда из уравнения \eqref{eq:vma} получим
\begin{equation}
	\mathbf y_{t+h} = \sum_{j=0}^{\infty} \mathbf B^j \mathbf P \mathbf P^{-1} \boldsymbol \epsilon_{t+h-j} =\sum_{j=0}^{\infty} \mathbf B^j \mathbf P  \mathbf v_{t+h-j} ,
\end{equation}
где
\begin{equation}
	\mathbf v_t = \mathbf P^{-1}  \boldsymbol \epsilon_t.
\end{equation}
В силу этой замены получаем, что
\begin{equation}
	\boldsymbol \epsilon_t = \mathbf P \mathbf v_t,
\end{equation}
то есть исходные ошибки будут заданы как
\begin{equation*}
	\begin{gathered}
		\epsilon_{t,1} = p_{11}v_{t,1},\\
		\epsilon_{t,2} = p_{21}v_{t,1} +  p_{22}v_{t,2},\\
		\vdots\\
		\epsilon_{t,n} = p_{n1}v_{t,1} +\ldots +  p_{nn}v_{t,n}.
	\end{gathered}
\end{equation*}
Причем новые ошибки $v_t$ не коррелируют друг с другом
\begin{equation*}
	\E \{ \mathbf v_t  \mathbf v_t^T\} =\mathbf P^{-1} \E\{\epsilon_t \epsilon_t^T\} (\mathbf P^{-1})^T =\mathbf P^{-1}\Sigma (\mathbf P^{-1})^T =\mathbf P^{-1}\mathbf P\mathbf P^T (\mathbf P^{-1})^T =  \mathbf E.
\end{equation*}
Таким образом, мы получим
\begin{equation}
	\dfrac{\partial y_{t+h}}{\partial \epsilon_{j,t}} = \mathbf B^h \mathbf P e_j,
\end{equation}
то есть матрицу импульсных откликов можно строить как в случае некоррелированных ошибок, так и в случае коррелированных. 

Также заметим, что если временные ряды в VAR модели заданы в процентах, то в случае единичного шока с помощью функции импульсных откликов можно наблюдать, на сколько процентов будут изменяться остальные переменные, а тогда сами отклики будут совпадать с эластичностям между двумя рядами в момент времени $h$.

Таким образом, для модели VAR мы определили два важных свойства: причинность по Грейнджеру и функции импульсных откликов. По наличию причинности по Грейнджеру и значимых откликов можно утверждать об опережающем характере одних переменных по отношению к другим. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Модель векторной авторегрессии по данным смешанной частоты MF-VAR}
\label{sec:mfvar}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Как мы определили ранее, стандартная модель VAR требует, чтобы все переменные имели одинаковую частоту. Этого можно добиться путем агрегирования данных высокой частоты, но в таком случае возникает потеря информации.
В одномерных моделях потеря информации устраняется путем применения модели MIDAS регрессии, которая на основе высокочастотных переменных создает новые низкочастотные переменные, которые сохраняют точность. Однако такой подход может привести к резкому увеличению числа нелинейных параметров, если использовать полиномиальные лаговые веса, особенно в случае многих экзогенных переменных. Чтобы
уменьшить количество параметров до более управляемого уровня, в тех случаях, когда количество
добавляемых переменных невелико, используется подход U-MIDAS.

Под моделью MF-VAR (\textit{Mixed Frequency Vector AutoRegression}) понимается такая VAR модель, для которой данные высокой частоты агрегируются с помощью модели U-MIDAS \eqref{u-midas}. То есть временной ряд высокой частоты, который замерен в $m$ раз чаще, чем ряд низкой частоты, раскладывается на $m$ временных рядов низкой частоты.

Пусть задан временной ряд $\{y_t^Q\}$ на квартальной частоте и $\{x_t^M\}$ на месячной частоте, $t\in T$. В соответствии с U-MIDAS подходом, раскладывая временной ряд $\{x_t^M\}$ месячной частоты на три временных ряда квартальной частоты $\{x_{t}^{M_1}\}$, $\{x_{t}^{M_2}\}$, $\{x_{t}^{M_3}\}$, мы можем построить модель MF-VAR($p$) как VAR($p$) вида

\begin{equation}
	\begin{aligned}
		y_t^Q = \mu_1 + \sum_{j = 1}^p \beta_j^{1,1} x_{t-j}^{M_1} + \sum_{j = 1}^p \beta_j^{1,2} x_{t-j}^{M_2} + \sum_{j = 1}^p \beta_j^{1,3} x_{t-j}^{M_3} + \sum_{j = 1}^p \beta_j^{1,4} y_{t-j}^Q + \epsilon_{t,1}^Q,\\
		x_{t}^{M_1} = \mu_2 + \sum_{j = 1}^p \beta_j^{2,1} x_{t-j}^{M_1} + \sum_{j = 1}^p \beta_j^{2,2} x_{t-j}^{M_2} + \sum_{j = 1}^p \beta_j^{2,3} x_{t-j}^{M_3} + \sum_{j = 1}^p \beta_j^{2,4} y_{t-j}^Q + \epsilon_{t,2}^Q,\\
		x_{t}^{M_2} = \mu_3 + \sum_{j = 1}^p \beta_j^{3,1} x_{t-j}^{M_1} + \sum_{j = 1}^p \beta_j^{3,2} x_{t-j}^{M_2} + \sum_{j = 1}^p \beta_j^{3,3} x_{t-j}^{M_3} + \sum_{j = 1}^p \beta_j^{3,4} y_{t-j}^Q + \epsilon_{t,3}^Q,\\
		x_{t}^{M_3} = \mu_4 + \sum_{j = 1}^p \beta_j^{4,1} x_{t-j}^{M_1} + \sum_{j = 1}^p \beta_j^{4,2} x_{t-j}^{M_2} + \sum_{j = 1}^p \beta_j^{4,3} x_{t-j}^{M_3} + \sum_{j = 1}^p \beta_j^{4,4} y_{t-j}^Q + \epsilon_{t,4}^Q,
	\end{aligned}
\end{equation}
где $\mu_i \in \mathbb R$, $\epsilon_{t,i}^Q \sim WN(0,\sigma^2)$, $i = \overline{1,4}$.

Обозначим векторы
\begin{equation*}
	\mathbf Y_t^Q = \begin{bmatrix}
		y_t^Q \\[2ex] x_{t,1}^Q \\[2ex] x_{t,2}^Q \\[2ex] x_{t,2}^Q
	\end{bmatrix},\ 
	\boldsymbol \mu = \begin{bmatrix}
		\mu_1 \\[2ex] \mu_2 \\[2ex] \mu_3 \\[2ex] \mu_4
	\end{bmatrix},\ 
	\mathbf B_j = \begin{bmatrix}
		\beta_j^{1,1} & \beta_j^{1,2} & \beta_j^{1,3} & \beta_j^{1,4} \\[2ex] 
		\beta_j^{2,1} & \beta_j^{2,2} & \beta_j^{2,3} & \beta_j^{2,4} \\[2ex] 
		\beta_j^{3,1} & \beta_j^{3,2} & \beta_j^{3,3} & \beta_j^{3,4} \\[2ex] 
		\beta_j^{4,1} & \beta_j^{4,2} & \beta_j^{4,3} & \beta_j^{4,4}
	\end{bmatrix},\
	\boldsymbol \epsilon_{t}^Q = \begin{bmatrix}
		\epsilon_{t,1}^Q \\[2ex] \epsilon_{t,2}^Q \\[2ex] \epsilon_{t,3}^Q \\[2ex] \epsilon_{t,4}^Q
	\end{bmatrix}.
\end{equation*}
и тогда можно записать MF-VAR($p$) модель в виде
\begin{equation}
	\label{eq:mfvar}
	\mathbf Y_t^Q = \mathbf \mu + \sum_{j=1}^{p}\mathbf B_j \times \mathbf Y_{t-j}^Q + \mathbf \epsilon_t^Q.
\end{equation}
Очевидно, что в модель можно добавлять больше низкочастотных и высокочастотных переменных, но надо учитывать, что высокочастотные переменные будут также раскладываться на три компоненты.

Остановимся подробно на количестве оцениваемых коэффициентов в модели. Если модель содержит $n_Q$ квартальных переменных и $n_M$ месячных переменных, то общее количество уравнений $n_Q + 3 n_M$. В каждом уравнении требуется оценить $1 + (n_Q + 3 n_M)\times p$ коэффициентов. Тогда для оценки всей системы требуется оценить 
\begin{equation*}
	[1 + (n_Q + 3 n_M)\times p] \times (n_Q + 3 n_M)
\end{equation*}
коэффициентов. Следовательно, при добавлении в модель новых высокочастотных факторов число параметров будет быстро возрастать. Поэтому значение $p$ должно быть относительно небольшим и высокочастотные переменные требуют тщательного отбора.

Таким образом, мы формально определили модель, которая будет применяться для решения задачи прогнозирования. Проблема выбора количества лагов $p$ и отбора высокочастотных переменных становится актуальной в условиях применения данной модели. Также она сохраняет свойства стандартной VAR модели, такие как причинность по Грейнджеру и функции импульсных откликов.

\section{Оценка точности модельных прогнозов}
Имея определенную модель для исследований необходимо сформулировать характеристики, по которым будет проводиться качественная оценка прогнозов модели.
\subsection{Критерии оценки точности прогнозов}
Для оценки качества прогнозов эконометрических моделей наиболее популярными являются два следующих критерия: 
\begin{itemize}
	\item MAE (\textit{Mean Absolute Error}) 
	\begin{equation}
		MAE = \dfrac{1}{T}\sum_{t=1}^{T}|y_t - \hat y _t|;
	\end{equation}
	\item RMSE (\textit{Root Mean Squared Error})
	\begin{equation}
		RMSE = \sqrt{\dfrac{1}{T}\sum_{t=1}^{T}(y_t - \hat y_t)^2},
	\end{equation}
\end{itemize}
где
\begin{itemize}
	\item $y_t$ --- фактическое значение эндогенной переменной в период $t$;
	\item $\hat y _t$ --- спрогнозированное с помощью модели значение эндогенной переменной в период $t$;
	\item $T$ --- количество периодов, на которых тестируется модель.
\end{itemize}  	
Остается определить период $T$, на котором будет тестироваться модель.
\subsection{Принцип наукастинга}
При построении наукастов не учитывается информация о последнем доступном квартале: перед оцениванием модели из выборки удаляются значения зависимых переменных и соответствующие данному кварталу месячные значения объясняющих переменных. Далее в выборку возвращаются удаленные значения регрессоров и для них рассчитывается прогнозное значение зависимой переменной (наукаст).

Для проверки устойчивости к добавлению новых данных все модели тестируются трижды: с использованием данных по объясняющим переменным за все три месяца квартала, для которого рассчитывается наукаст; без данных за последний месяц и без данных за два последних месяца. В случае удаления части данных в объясняющих переменных, «пустым» месяцам в объясняющих переменных проставляется последнее доступное значение показателя (за второй или за первый месяц квартала в зависимости от метода тестирования). Такая проверка позволяет определить, насколько методы устойчивы к объему используемых данных, и смоделировать встречающиеся в реальной жизни условия, когда наукаст показателя за текущий квартал рассчитывается еще до окончания квартала. 

\subsection{Алгоритм оценки точности по методу расширяющегося окна}
\label{subsec:exp-win}

Оценка модели по одному вневыборочному значению может оказаться недостаточно точной. Более точные результаты можно получить, построив оценки по нескольким вневыборочным точкам. Но в силу того, что MF-VAR модель пригодна для краткосрочного прогнозирования, строить прогноз на несколько точек вперед не эффективно.

Для решения описанной проблемы используется подход \textit{расширяющегося окна}.
\begin{enumerate}
	\item Вся выборка данных первоначально делится на две части -- обучающую и тестируемую. В результате в обучающую
	выборку входят наблюдения $y_1,\ldots, y_t$, а в тестируемую -- наблюдения $y_{t+1},\ldots, y_T$.
	\item Основываясь на фактических временных рядах обучающей выборки осуществляется
	оценка параметров модели.
	\item С помощью оцененной модели производится прогноз $\hat y_{t+1}$ на один квартал вперед.
	\item Увеличивается длина обучающей выборки на один квартал, то есть теперь в нее входят наблюдения $y_1,\ldots, y_t, y_{t+1}$, и заново оцениваются
	параметры модели.
	\item Используя переоцененную модель с учетом увеличенной выборки, производится прогноз $\hat y_{t+2}$ на один квартал вперед.
	\item Далее аналогично шагам 4 и 5 последовательно увеличивается выборка, переоценивается модель и строится прогноз на один квартал вперед до тех пор, пока выборка не будет включать все наблюдения $y_{1},\ldots, y_T$.
	\item В результате получены точечные прогнозы $\hat y_{t+1},\ldots, \hat y_T$ темпов прироста реального ВВП, которые сравниваются с фактическими данными и рассчитываются метрики качества модели
\end{enumerate}
\begin{equation*}
	MAE = \dfrac{1}{T - t - 1} \sum_{i=t+1}^{T}|y_{i} - \hat y_{i}|,
\end{equation*}
\begin{equation*}
	RMSE = \sqrt{\dfrac{1}{T - t - 1} \sum_{i=t+1}^{T}(y_{i} - \hat y_{i})^2}.
\end{equation*}
Приведенный алгоритм расширения выборки с переоценкой коэффициентов и называется \textit{методом расширяющегося окна}.

Окно можно расширять также на два значения $y_{t+1}, y_{t+2}$ или более. Но тогда могут возникать коллизии с тем, что и на первом, и на втором шаге алгоритма строятся, вообще говоря, разные оценки $\hat y_{t+2}$. В таком случае нужно подробно останавливаться на выборе конкретной оценки для $y_{t+2}$: как среднего или как значения с наименьшим отклонением.

Таким образом, алгоритм расширяющегося окна позволяет оценивать точность краткосрочных прогнозов на некотором периоде $t+1,\ldots, T$.
